function [z,A,B] = somb2d(x,y,c)%SOMB2D  Generates a sombrero surface Z(X,Y) as defined %  by Gaskill (1978), p. 72. First zero-crossing is at x=1.22, y=0%% Use: [z,A,B] = somb2d(x,y,c)%%	Input vectors x and y specify the domain over which the function%	 is to be evaluated.  If only x is supplied, we assume y=x.%    Example: s=[-2:.1:2];  mesh(somb2d(s))%   center = 1x2 vector specifying [xcenter,ycenter] of the function%% In optics, the diffraction pattern produced by a circular aperture%  (the Airy pattern) has a cross-section given by [somb(x)]^2% The zero-crossing = radius of central core of Airy disk occurs for%  x = 1.22*lambda/pupil diameter radians subtended at the pupil plane.% Since somb(x) crosses zero at x=1.22, the x- axis can be converted to%  angular radians by the eqn. r=x*lambda/dia where lambda and dia are in%  the same units (e.g. mm).%%  Another optics application is the geometrical optics approximation of the%  blur circle for defocus.  If the PSF is a cylinder of diameter B=PD, where%  P=pupil diameter and D=defocus, then the MTF will be a SOMB2D function.%  According to Goodman, p. 15,16, the Fourier transform of the circ(r) function%  (a cylinder of unit radius & unit height, vol=pi) is J1(2*pi*f)/f where f=radial freq.%  The central ordinate of this result is pi, so to get a valid MTF we divide by pi%  which is equivalent to making the cylinder have unit volume.%  For convenience multiply by 2/2 to get 2J1(2*pi*f)/(2*pi*f).%  A 1-D cross-section of this function is recognized as somb(2f), so the full 2-D%  function is somb2d(2f).  The zero-crossing occurs for 2f=1.22, or f=0.61.%  Now, applying the scaling theorem to this result, the FT of a circular disk of%  radius r will be somb2d(2rf) = somb2d(BlurCircleDia*f) = somb2d(PupilDia*defocus*f).%  and so the first zero-crossing is for f=1.22/(PupilDia*defocus)%  Units: if PupilDia is in mm, and defocus is in diopters, then PupilDia*defocus%   is in mrad.  Multiply by 3.44 arcmin/mrad * deg/60 arcmin) to get deg,%   which gives f the units of cyc/deg.  Example: 3mm pupil dia, 1D defocus%   makes blur circle dia=10arcmin=1/6 deg, so f(zero)=1.22/(1/6)=7.3 cyc/deg%% LNT 2-Nov-94% LNT 23 May 01, return the support grid to calling program% LNT 6-Oct-01, add some comments about optics.% LNT 13-Jul-2011. Add input argument c.%% © 1994, 2001 Larry Thibos, Indiana Universityif nargin <2, y=x; endif nargin <3 || isempty(c), c=[0 0]; end[A,B] = meshgrid(x,y);         	% get array of (x,y) coordinatesC=A-c(1); D=B-c(2);             % displace the coordinate originz = somb(sqrt((C.*C+D.*D))); 	% use 1D somb to calculate z-values