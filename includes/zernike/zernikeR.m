function Z=zernikeR(x,y,n,pd)%ZernikeR   Evaluate Zernike circle polynomial of mode N for sample points%			specified in RECTANGULAR coordinates.%%  Use: Z = zernikeR(x,y,n,pd)%%	Z=zernikeR(x,y,n,pd) returns matrix Z filled with samples of the Zernike %	polynomials for any single mode up to N=66 (10th order). %%	NOTE: This version exchanges x&y in Malacara's formulas in order to obey % 	the standard mathematical convention that x=r*cos(theta), y=r*sin(theta).%	Equations were generated automatically by Make_N_OrdersR.m   Had to manually %	  fix n=1 casefor heights, and n=1 to 3 cases for derivatives.%%	Input arguments:%		x,y are scalars, vectors, or matrices specifying the sample points  %		  upon which the Zernike functions are to be evaluated.%		x and y must be normalised coordinates inside the unit circle.%		n = mode of the Zernike polynomial. must be an integer 1<=n<=66. %			numbering scheme is: n = 1 = piston.  OSA mode number = n-1.%	%		pd is optional. Valid values of pd are 'dx' or 'dy' or 'h'%		  'dx' evaluates the partial derivative of the Zernike with respect to x%	 	  'dy' evaluates the partial derivative of the Zernike with respect to y%		  'h' evaluates the surface height (i.e. same as if pd were omitted)%%	Output Z is a vector or matrix of the same size as x and y.%%	LNT 8-Mar-98. Do orders 0-5.  %	LNT 9-Mar-98  Add orders 6-10.%	LNT 9-Mar-98. Redo the lot, this time with normalization constants included.%					The result should be a set of orthonormal functions.%	LNT 14-Mar-98  Redo the lot, with numbering scheme: mode 1= constant (piston).%	LNT 10-Mar-99  Correct flub in initial legality check on pd.%	LNT 16-Nov-99  Changing ordering convention in polar form (see ZernikeStringP.m)%					has no effect here because we still maintain math conventions.%% See also: ZERNIKEP, ZERNIKER_ALLnarginchk(3,4);if nargin==4,	pd=lower(pd);	if  any(pd~='dx' & pd~='dy' & pd~='h')	error('The only valid values for pd are dx, dy, and h.');	endendif n<1 | n>66	error('n is the mode of the Zernike polynomial and must be an integer 1<=n<=66.');endif size(x)~=size(y)	error('x and y must be the same size.'); endif nargin==3 | pd=='h'if n==1; Z= ones(size(x)); end                                                                         if n==2; Z=sqrt(2*(1+1))*( +1.*y); end                                                                      if n==3; Z=sqrt(2*(1+1))*( +1.*x); end                                                                      if n==4; Z=sqrt(2*(2+1))*( +2.*x.*y); end                                                                   if n==5; Z=sqrt(2+1)*( +2.*x.^2 +2.*y.^2 -1); end                                                           if n==6; Z=sqrt(2*(2+1))*( +1.*x.^2 -1.*y.^2); end                                                          if n==7; Z=sqrt(2*(3+1))*( +3.*x.^2.*y -1.*y.^3); end                                                       if n==8; Z=sqrt(2*(3+1))*( +3.*x.^2.*y +3.*y.^3 -2.*y); end                                                 if n==9; Z=sqrt(2*(3+1))*( +3.*x.^3 +3.*x.*y.^2 -2.*x); end                                                 if n==10; Z=sqrt(2*(3+1))*( +1.*x.^3 -3.*x.*y.^2); end                                                      if n==11; Z=sqrt(2*(4+1))*( +4.*x.^3.*y -4.*x.*y.^3); end                                                   if n==12; Z=sqrt(2*(4+1))*( +8.*x.^3.*y +8.*x.*y.^3 -6.*x.*y); end                                          if n==13; Z=sqrt(4+1)*( +6.*x.^4 +12.*x.^2.*y.^2 +6.*y.^4 -6.*x.^2 -6.*y.^2 +1); end                        if n==14; Z=sqrt(2*(4+1))*( +4.*x.^4 +4.*x.^2.*y.^2 -3.*x.^2 -4.*x.^2.*y.^2 -4.*y.^4 +3.*y.^2); end         if n==15; Z=sqrt(2*(4+1))*( +1.*x.^4 -6.*x.^2.*y.^2 +1.*y.^4); end                                          if n==16; Z=sqrt(2*(5+1))*( +5.*x.^4.*y -10.*x.^2.*y.^3 +1.*y.^5); end                                      if n==17; Z=sqrt(2*(5+1))*( +15.*x.^4.*y +15.*x.^2.*y.^3 -12.*x.^2.*y -5.*x.^2.*y.^3 -5.*y.^5 +4.*y.^3); endif n==18; Z=sqrt(2*(5+1))*( +10.*x.^4.*y +20.*x.^2.*y.^3 +10.*y.^5 -12.*x.^2.*y -12.*y.^3 +3.*y); end       if n==19; Z=sqrt(2*(5+1))*( +10.*x.^5 +20.*x.^3.*y.^2 +10.*x.*y.^4 -12.*x.^3 -12.*x.*y.^2 +3.*x); end       if n==20; Z=sqrt(2*(5+1))*( +5.*x.^5 +5.*x.^3.*y.^2 -4.*x.^3 -15.*x.^3.*y.^2 -15.*x.*y.^4 +12.*x.*y.^2); endif n==21; Z=sqrt(2*(5+1))*( +1.*x.^5 -10.*x.^3.*y.^2 +5.*x.*y.^4); end                                      if n==22; Z=sqrt(2*(6+1))*( +6.*x.^5.*y -20.*x.^3.*y.^3 +6.*x.*y.^5); end                                                                                                                                                                                                                                                                                                                                                                                                                                              if n==23; Z=sqrt(2*(6+1))*( +24.*x.^5.*y +24.*x.^3.*y.^3 -20.*x.^3.*y -24.*x.^3.*y.^3 -24.*x.*y.^5 +20.*x.*y.^3); end                                                                                                                                                                                                                                                                                                                                                                                                  if n==24; Z=sqrt(2*(6+1))*( +30.*x.^5.*y +60.*x.^3.*y.^3 +30.*x.*y.^5 -40.*x.^3.*y -40.*x.*y.^3 +12.*x.*y); end                                                                                                                                                                                                                                                                                                                                                                                                        if n==25; Z=sqrt(6+1)*( +20.*x.^6 +60.*x.^4.*y.^2 +60.*x.^2.*y.^4 +20.*y.^6 -30.*x.^4 -60.*x.^2.*y.^2 -30.*y.^4 +12.*x.^2 +12.*y.^2 -1); end                                                                                                                                                                                                                                                                                                                                                                           if n==26; Z=sqrt(2*(6+1))*( +15.*x.^6 +30.*x.^4.*y.^2 +15.*x.^2.*y.^4 -20.*x.^4 -20.*x.^2.*y.^2 +6.*x.^2 -15.*x.^4.*y.^2 -30.*x.^2.*y.^4 -15.*y.^6 +20.*x.^2.*y.^2 +20.*y.^4 -6.*y.^2); end                                                                                                                                                                                                                                                                                                                            if n==27; Z=sqrt(2*(6+1))*( +6.*x.^6 +6.*x.^4.*y.^2 -5.*x.^4 -36.*x.^4.*y.^2 -36.*x.^2.*y.^4 +30.*x.^2.*y.^2 +6.*x.^2.*y.^4 +6.*y.^6 -5.*y.^4); end                                                                                                                                                                                                                                                                                                                                                                    if n==28; Z=sqrt(2*(6+1))*( +1.*x.^6 -15.*x.^4.*y.^2 +15.*x.^2.*y.^4 -1.*y.^6); end                                                                                                                                                                                                                                                                                                                                                                                                                                    if n==29; Z=sqrt(2*(7+1))*( +7.*x.^6.*y -35.*x.^4.*y.^3 +21.*x.^2.*y.^5 -1.*y.^7); end                                                                                                                                                                                                                                                                                                                                                                                                                                 if n==30; Z=sqrt(2*(7+1))*( +35.*x.^6.*y +35.*x.^4.*y.^3 -30.*x.^4.*y -70.*x.^4.*y.^3 -70.*x.^2.*y.^5 +60.*x.^2.*y.^3 +7.*x.^2.*y.^5 +7.*y.^7 -6.*y.^5); end                                                                                                                                                                                                                                                                                                                                                           if n==31; Z=sqrt(2*(7+1))*( +63.*x.^6.*y +126.*x.^4.*y.^3 +63.*x.^2.*y.^5 -90.*x.^4.*y -90.*x.^2.*y.^3 +30.*x.^2.*y -21.*x.^4.*y.^3 -42.*x.^2.*y.^5 -21.*y.^7 +30.*x.^2.*y.^3 +30.*y.^5 -10.*y.^3); end                                                                                                                                                                                                                                                                                                                if n==32; Z=sqrt(2*(7+1))*( +35.*x.^6.*y +105.*x.^4.*y.^3 +105.*x.^2.*y.^5 +35.*y.^7 -60.*x.^4.*y -120.*x.^2.*y.^3 -60.*y.^5 +30.*x.^2.*y +30.*y.^3 -4.*y); end                                                                                                                                                                                                                                                                                                                                                        if n==33; Z=sqrt(2*(7+1))*( +35.*x.^7 +105.*x.^5.*y.^2 +105.*x.^3.*y.^4 +35.*x.*y.^6 -60.*x.^5 -120.*x.^3.*y.^2 -60.*x.*y.^4 +30.*x.^3 +30.*x.*y.^2 -4.*x); end                                                                                                                                                                                                                                                                                                                                                        if n==34; Z=sqrt(2*(7+1))*( +21.*x.^7 +42.*x.^5.*y.^2 +21.*x.^3.*y.^4 -30.*x.^5 -30.*x.^3.*y.^2 +10.*x.^3 -63.*x.^5.*y.^2 -126.*x.^3.*y.^4 -63.*x.*y.^6 +90.*x.^3.*y.^2 +90.*x.*y.^4 -30.*x.*y.^2); end                                                                                                                                                                                                                                                                                                                if n==35; Z=sqrt(2*(7+1))*( +7.*x.^7 +7.*x.^5.*y.^2 -6.*x.^5 -70.*x.^5.*y.^2 -70.*x.^3.*y.^4 +60.*x.^3.*y.^2 +35.*x.^3.*y.^4 +35.*x.*y.^6 -30.*x.*y.^4); end                                                                                                                                                                                                                                                                                                                                                           if n==36; Z=sqrt(2*(7+1))*( +1.*x.^7 -21.*x.^5.*y.^2 +35.*x.^3.*y.^4 -7.*x.*y.^6); end                                                                                                                                                                                                                                                                                                                                                                                                                                 if n==37; Z=sqrt(2*(8+1))*( +8.*x.^7.*y -56.*x.^5.*y.^3 +56.*x.^3.*y.^5 -8.*x.*y.^7); end                                                                                                                                                                                                                                                                                                                                                                                                                              if n==38; Z=sqrt(2*(8+1))*( +48.*x.^7.*y +48.*x.^5.*y.^3 -42.*x.^5.*y -160.*x.^5.*y.^3 -160.*x.^3.*y.^5 +140.*x.^3.*y.^3 +48.*x.^3.*y.^5 +48.*x.*y.^7 -42.*x.*y.^5); end                                                                                                                                                                                                                                                                                                                                               if n==39; Z=sqrt(2*(8+1))*( +112.*x.^7.*y +224.*x.^5.*y.^3 +112.*x.^3.*y.^5 -168.*x.^5.*y -168.*x.^3.*y.^3 +60.*x.^3.*y -112.*x.^5.*y.^3 -224.*x.^3.*y.^5 -112.*x.*y.^7 +168.*x.^3.*y.^3 +168.*x.*y.^5 -60.*x.*y.^3); end                                                                                                                                                                                                                                                                                              if n==40; Z=sqrt(2*(8+1))*( +112.*x.^7.*y +336.*x.^5.*y.^3 +336.*x.^3.*y.^5 +112.*x.*y.^7 -210.*x.^5.*y -420.*x.^3.*y.^3 -210.*x.*y.^5 +120.*x.^3.*y +120.*x.*y.^3 -20.*x.*y); end                                                                                                                                                                                                                                                                                                                                     if n==41; Z=sqrt(8+1)*( +70.*x.^8 +280.*x.^6.*y.^2 +420.*x.^4.*y.^4 +280.*x.^2.*y.^6 +70.*y.^8 -140.*x.^6 -420.*x.^4.*y.^2 -420.*x.^2.*y.^4 -140.*y.^6 +90.*x.^4 +180.*x.^2.*y.^2 +90.*y.^4 -20.*x.^2 -20.*y.^2 +1); end                                                                                                                                                                                                                                                                                               if n==42; Z=sqrt(2*(8+1))*( +56.*x.^8 +168.*x.^6.*y.^2 +168.*x.^4.*y.^4 +56.*x.^2.*y.^6 -105.*x.^6 -210.*x.^4.*y.^2 -105.*x.^2.*y.^4 +60.*x.^4 +60.*x.^2.*y.^2 -10.*x.^2 -56.*x.^6.*y.^2 -168.*x.^4.*y.^4 -168.*x.^2.*y.^6 -56.*y.^8 +105.*x.^4.*y.^2 +210.*x.^2.*y.^4 +105.*y.^6 -60.*x.^2.*y.^2 -60.*y.^4 +10.*y.^2); end                                                                                                                                                                                            if n==43; Z=sqrt(2*(8+1))*( +28.*x.^8 +56.*x.^6.*y.^2 +28.*x.^4.*y.^4 -42.*x.^6 -42.*x.^4.*y.^2 +15.*x.^4 -168.*x.^6.*y.^2 -336.*x.^4.*y.^4 -168.*x.^2.*y.^6 +252.*x.^4.*y.^2 +252.*x.^2.*y.^4 -90.*x.^2.*y.^2 +28.*x.^4.*y.^4 +56.*x.^2.*y.^6 +28.*y.^8 -42.*x.^2.*y.^4 -42.*y.^6 +15.*y.^4); end                                                                                                                                                                                                                     if n==44; Z=sqrt(2*(8+1))*( +8.*x.^8 +8.*x.^6.*y.^2 -7.*x.^6 -120.*x.^6.*y.^2 -120.*x.^4.*y.^4 +105.*x.^4.*y.^2 +120.*x.^4.*y.^4 +120.*x.^2.*y.^6 -105.*x.^2.*y.^4 -8.*x.^2.*y.^6 -8.*y.^8 +7.*y.^6); end                                                                                                                                                                                                                                                                                                              if n==45; Z=sqrt(2*(8+1))*( +1.*x.^8 -28.*x.^6.*y.^2 +70.*x.^4.*y.^4 -28.*x.^2.*y.^6 +1.*y.^8); end                                                                                                                                                                                                                                                                                                                                                                                                                    if n==46; Z=sqrt(2*(9+1))*( +9.*x.^8.*y -84.*x.^6.*y.^3 +126.*x.^4.*y.^5 -36.*x.^2.*y.^7 +1.*y.^9); end                                                                                                                                                                                                                                                                                                                                                                                                                if n==47; Z=sqrt(2*(9+1))*( +63.*x.^8.*y +63.*x.^6.*y.^3 -56.*x.^6.*y -315.*x.^6.*y.^3 -315.*x.^4.*y.^5 +280.*x.^4.*y.^3 +189.*x.^4.*y.^5 +189.*x.^2.*y.^7 -168.*x.^2.*y.^5 -9.*x.^2.*y.^7 -9.*y.^9 +8.*y.^7); end                                                                                                                                                                                                                                                                                                     if n==48; Z=sqrt(2*(9+1))*( +180.*x.^8.*y +360.*x.^6.*y.^3 +180.*x.^4.*y.^5 -280.*x.^6.*y -280.*x.^4.*y.^3 +105.*x.^4.*y -360.*x.^6.*y.^3 -720.*x.^4.*y.^5 -360.*x.^2.*y.^7 +560.*x.^4.*y.^3 +560.*x.^2.*y.^5 -210.*x.^2.*y.^3 +36.*x.^4.*y.^5 +72.*x.^2.*y.^7 +36.*y.^9 -56.*x.^2.*y.^5 -56.*y.^7 +21.*y.^5); end                                                                                                                                                                                                     if n==49; Z=sqrt(2*(9+1))*( +252.*x.^8.*y +756.*x.^6.*y.^3 +756.*x.^4.*y.^5 +252.*x.^2.*y.^7 -504.*x.^6.*y -1008.*x.^4.*y.^3 -504.*x.^2.*y.^5 +315.*x.^4.*y +315.*x.^2.*y.^3 -60.*x.^2.*y -84.*x.^6.*y.^3 -252.*x.^4.*y.^5 -252.*x.^2.*y.^7 -84.*y.^9 +168.*x.^4.*y.^3 +336.*x.^2.*y.^5 +168.*y.^7 -105.*x.^2.*y.^3 -105.*y.^5 +20.*y.^3); end                                                                                                                                                                         if n==50; Z=sqrt(2*(9+1))*( +126.*x.^8.*y +504.*x.^6.*y.^3 +756.*x.^4.*y.^5 +504.*x.^2.*y.^7 +126.*y.^9 -280.*x.^6.*y -840.*x.^4.*y.^3 -840.*x.^2.*y.^5 -280.*y.^7 +210.*x.^4.*y +420.*x.^2.*y.^3 +210.*y.^5 -60.*x.^2.*y -60.*y.^3 +5.*y); end                                                                                                                                                                                                                                                                        if n==51; Z=sqrt(2*(9+1))*( +126.*x.^9 +504.*x.^7.*y.^2 +756.*x.^5.*y.^4 +504.*x.^3.*y.^6 +126.*x.*y.^8 -280.*x.^7 -840.*x.^5.*y.^2 -840.*x.^3.*y.^4 -280.*x.*y.^6 +210.*x.^5 +420.*x.^3.*y.^2 +210.*x.*y.^4 -60.*x.^3 -60.*x.*y.^2 +5.*x); end                                                                                                                                                                                                                                                                        if n==52; Z=sqrt(2*(9+1))*( +84.*x.^9 +252.*x.^7.*y.^2 +252.*x.^5.*y.^4 +84.*x.^3.*y.^6 -168.*x.^7 -336.*x.^5.*y.^2 -168.*x.^3.*y.^4 +105.*x.^5 +105.*x.^3.*y.^2 -20.*x.^3 -252.*x.^7.*y.^2 -756.*x.^5.*y.^4 -756.*x.^3.*y.^6 -252.*x.*y.^8 +504.*x.^5.*y.^2 +1008.*x.^3.*y.^4 +504.*x.*y.^6 -315.*x.^3.*y.^2 -315.*x.*y.^4 +60.*x.*y.^2); end                                                                                                                                                                         if n==53; Z=sqrt(2*(9+1))*( +36.*x.^9 +72.*x.^7.*y.^2 +36.*x.^5.*y.^4 -56.*x.^7 -56.*x.^5.*y.^2 +21.*x.^5 -360.*x.^7.*y.^2 -720.*x.^5.*y.^4 -360.*x.^3.*y.^6 +560.*x.^5.*y.^2 +560.*x.^3.*y.^4 -210.*x.^3.*y.^2 +180.*x.^5.*y.^4 +360.*x.^3.*y.^6 +180.*x.*y.^8 -280.*x.^3.*y.^4 -280.*x.*y.^6 +105.*x.*y.^4); end                                                                                                                                                                                                     if n==54; Z=sqrt(2*(9+1))*( +9.*x.^9 +9.*x.^7.*y.^2 -8.*x.^7 -189.*x.^7.*y.^2 -189.*x.^5.*y.^4 +168.*x.^5.*y.^2 +315.*x.^5.*y.^4 +315.*x.^3.*y.^6 -280.*x.^3.*y.^4 -63.*x.^3.*y.^6 -63.*x.*y.^8 +56.*x.*y.^6); end                                                                                                                                                                                                                                                                                                     if n==55; Z=sqrt(2*(9+1))*( +1.*x.^9 -36.*x.^7.*y.^2 +126.*x.^5.*y.^4 -84.*x.^3.*y.^6 +9.*x.*y.^8); end                                                                                                                                                                                                                                                                                                                                                                                                                if n==56; Z=sqrt(2*(10+1))*( +10.*x.^9.*y -120.*x.^7.*y.^3 +252.*x.^5.*y.^5 -120.*x.^3.*y.^7 +10.*x.*y.^9); end                                                                                                                                                                                                                                                                                                                                                                                                        if n==57; Z=sqrt(2*(10+1))*( +80.*x.^9.*y +80.*x.^7.*y.^3 -72.*x.^7.*y -560.*x.^7.*y.^3 -560.*x.^5.*y.^5 +504.*x.^5.*y.^3 +560.*x.^5.*y.^5 +560.*x.^3.*y.^7 -504.*x.^3.*y.^5 -80.*x.^3.*y.^7 -80.*x.*y.^9 +72.*x.*y.^7); end                                                                                                                                                                                                                                                                                           if n==58; Z=sqrt(2*(10+1))*( +270.*x.^9.*y +540.*x.^7.*y.^3 +270.*x.^5.*y.^5 -432.*x.^7.*y -432.*x.^5.*y.^3 +168.*x.^5.*y -900.*x.^7.*y.^3 -1800.*x.^5.*y.^5 -900.*x.^3.*y.^7 +1440.*x.^5.*y.^3 +1440.*x.^3.*y.^5 -560.*x.^3.*y.^3 +270.*x.^5.*y.^5 +540.*x.^3.*y.^7 +270.*x.*y.^9 -432.*x.^3.*y.^5 -432.*x.*y.^7 +168.*x.*y.^5); end                                                                                                                                                                                  if n==59; Z=sqrt(2*(10+1))*( +480.*x.^9.*y +1440.*x.^7.*y.^3 +1440.*x.^5.*y.^5 +480.*x.^3.*y.^7 -1008.*x.^7.*y -2016.*x.^5.*y.^3 -1008.*x.^3.*y.^5 +672.*x.^5.*y +672.*x.^3.*y.^3 -140.*x.^3.*y -480.*x.^7.*y.^3 -1440.*x.^5.*y.^5 -1440.*x.^3.*y.^7 -480.*x.*y.^9 +1008.*x.^5.*y.^3 +2016.*x.^3.*y.^5 +1008.*x.*y.^7 -672.*x.^3.*y.^3 -672.*x.*y.^5 +140.*x.*y.^3); end                                                                                                                                               if n==60; Z=sqrt(2*(10+1))*( +420.*x.^9.*y +1680.*x.^7.*y.^3 +2520.*x.^5.*y.^5 +1680.*x.^3.*y.^7 +420.*x.*y.^9 -1008.*x.^7.*y -3024.*x.^5.*y.^3 -3024.*x.^3.*y.^5 -1008.*x.*y.^7 +840.*x.^5.*y +1680.*x.^3.*y.^3 +840.*x.*y.^5 -280.*x.^3.*y -280.*x.*y.^3 +30.*x.*y); end                                                                                                                                                                                                                                             if n==61; Z=sqrt(10+1)*( +252.*x.^10 +1260.*x.^8.*y.^2 +2520.*x.^6.*y.^4 +2520.*x.^4.*y.^6 +1260.*x.^2.*y.^8 +252.*y.^10 -630.*x.^8 -2520.*x.^6.*y.^2 -3780.*x.^4.*y.^4 -2520.*x.^2.*y.^6 -630.*y.^8 +560.*x.^6 +1680.*x.^4.*y.^2 +1680.*x.^2.*y.^4 +560.*y.^6 -210.*x.^4 -420.*x.^2.*y.^2 -210.*y.^4 +30.*x.^2 +30.*y.^2 -1); end                                                                                                                                                                                     if n==62; Z=sqrt(2*(10+1))*( +210.*x.^10 +840.*x.^8.*y.^2 +1260.*x.^6.*y.^4 +840.*x.^4.*y.^6 +210.*x.^2.*y.^8 -504.*x.^8 -1512.*x.^6.*y.^2 -1512.*x.^4.*y.^4 -504.*x.^2.*y.^6 +420.*x.^6 +840.*x.^4.*y.^2 +420.*x.^2.*y.^4 -140.*x.^4 -140.*x.^2.*y.^2 +15.*x.^2 -210.*x.^8.*y.^2 -840.*x.^6.*y.^4 -1260.*x.^4.*y.^6 -840.*x.^2.*y.^8 -210.*y.^10 +504.*x.^6.*y.^2 +1512.*x.^4.*y.^4 +1512.*x.^2.*y.^6 +504.*y.^8 -420.*x.^4.*y.^2 -840.*x.^2.*y.^4 -420.*y.^6 +140.*x.^2.*y.^2 +140.*y.^4 -15.*y.^2); end             if n==63; Z=sqrt(2*(10+1))*( +120.*x.^10 +360.*x.^8.*y.^2 +360.*x.^6.*y.^4 +120.*x.^4.*y.^6 -252.*x.^8 -504.*x.^6.*y.^2 -252.*x.^4.*y.^4 +168.*x.^6 +168.*x.^4.*y.^2 -35.*x.^4 -720.*x.^8.*y.^2 -2160.*x.^6.*y.^4 -2160.*x.^4.*y.^6 -720.*x.^2.*y.^8 +1512.*x.^6.*y.^2 +3024.*x.^4.*y.^4 +1512.*x.^2.*y.^6 -1008.*x.^4.*y.^2 -1008.*x.^2.*y.^4 +210.*x.^2.*y.^2 +120.*x.^6.*y.^4 +360.*x.^4.*y.^6 +360.*x.^2.*y.^8 +120.*y.^10 -252.*x.^4.*y.^4 -504.*x.^2.*y.^6 -252.*y.^8 +168.*x.^2.*y.^4 +168.*y.^6 -35.*y.^4); endif n==64; Z=sqrt(2*(10+1))*( +45.*x.^10 +90.*x.^8.*y.^2 +45.*x.^6.*y.^4 -72.*x.^8 -72.*x.^6.*y.^2 +28.*x.^6 -675.*x.^8.*y.^2 -1350.*x.^6.*y.^4 -675.*x.^4.*y.^6 +1080.*x.^6.*y.^2 +1080.*x.^4.*y.^4 -420.*x.^4.*y.^2 +675.*x.^6.*y.^4 +1350.*x.^4.*y.^6 +675.*x.^2.*y.^8 -1080.*x.^4.*y.^4 -1080.*x.^2.*y.^6 +420.*x.^2.*y.^4 -45.*x.^4.*y.^6 -90.*x.^2.*y.^8 -45.*y.^10 +72.*x.^2.*y.^6 +72.*y.^8 -28.*y.^6); end                                                                                                     if n==65; Z=sqrt(2*(10+1))*( +10.*x.^10 +10.*x.^8.*y.^2 -9.*x.^8 -280.*x.^8.*y.^2 -280.*x.^6.*y.^4 +252.*x.^6.*y.^2 +700.*x.^6.*y.^4 +700.*x.^4.*y.^6 -630.*x.^4.*y.^4 -280.*x.^4.*y.^6 -280.*x.^2.*y.^8 +252.*x.^2.*y.^6 +10.*x.^2.*y.^8 +10.*y.^10 -9.*y.^8); end                                                                                                                                                                                                                                                    if n==66; Z=sqrt(2*(10+1))*( +1.*x.^10 -45.*x.^8.*y.^2 +210.*x.^6.*y.^4 -210.*x.^4.*y.^6 +45.*x.^2.*y.^8 -1.*y.^10); end                                                                                                                                                                                                                                                                                                                                                                                               elseif pd=='dx'if n==1; Z=zeros(size(x)); endif n==2; Z=zeros(size(x)); endif n==3; Z=sqrt(2*(1+1))*ones(size(x)); end                                                                   if n==4; Z=sqrt(2*(2+1))*( +2.*y); end                                                                   if n==5; Z=sqrt(2+1)*( +4.*x); end                                                                       if n==6; Z=sqrt(2*(2+1))*( +2.*x); end                                                                   if n==7; Z=sqrt(2*(3+1))*( +6.*x.*y); end                                                                if n==8; Z=sqrt(2*(3+1))*( +6.*x.*y); end                                                                if n==9; Z=sqrt(2*(3+1))*( +9.*x.^2 +3.*y.^2 -2); end                                                    if n==10; Z=sqrt(2*(3+1))*( +3.*x.^2 -3.*y.^2); end                                                      if n==11; Z=sqrt(2*(4+1))*( +12.*x.^2.*y -4.*y.^3); end                                                  if n==12; Z=sqrt(2*(4+1))*( +24.*x.^2.*y +8.*y.^3 -6.*y); end                                            if n==13; Z=sqrt(4+1)*( +24.*x.^3 +24.*x.*y.^2 -12.*x); end                                              if n==14; Z=sqrt(2*(4+1))*( +16.*x.^3 +8.*x.*y.^2 -6.*x -8.*x.*y.^2); end                                if n==15; Z=sqrt(2*(4+1))*( +4.*x.^3 -12.*x.*y.^2); end                                                  if n==16; Z=sqrt(2*(5+1))*( +20.*x.^3.*y -20.*x.*y.^3); end                                              if n==17; Z=sqrt(2*(5+1))*( +60.*x.^3.*y +30.*x.*y.^3 -24.*x.*y -10.*x.*y.^3); end                       if n==18; Z=sqrt(2*(5+1))*( +40.*x.^3.*y +40.*x.*y.^3 -24.*x.*y); end                                    if n==19; Z=sqrt(2*(5+1))*( +50.*x.^4 +60.*x.^2.*y.^2 +10.*y.^4 -36.*x.^2 -12.*y.^2 +3); end             if n==20; Z=sqrt(2*(5+1))*( +25.*x.^4 +15.*x.^2.*y.^2 -12.*x.^2 -45.*x.^2.*y.^2 -15.*y.^4 +12.*y.^2); endif n==21; Z=sqrt(2*(5+1))*( +5.*x.^4 -30.*x.^2.*y.^2 +5.*y.^4); end                                      if n==22; Z=sqrt(2*(6+1))*( +30.*x.^4.*y -60.*x.^2.*y.^3 +6.*y.^5); end                                                                                                                                                                                                                                                                                                                                                                                             if n==23; Z=sqrt(2*(6+1))*( +120.*x.^4.*y +72.*x.^2.*y.^3 -60.*x.^2.*y -72.*x.^2.*y.^3 -24.*y.^5 +20.*y.^3); end                                                                                                                                                                                                                                                                                                                                                    if n==24; Z=sqrt(2*(6+1))*( +150.*x.^4.*y +180.*x.^2.*y.^3 +30.*y.^5 -120.*x.^2.*y -40.*y.^3 +12.*y); end                                                                                                                                                                                                                                                                                                                                                           if n==25; Z=sqrt(6+1)*( +120.*x.^5 +240.*x.^3.*y.^2 +120.*x.*y.^4 -120.*x.^3 -120.*x.*y.^2 +24.*x); end                                                                                                                                                                                                                                                                                                                                                             if n==26; Z=sqrt(2*(6+1))*( +90.*x.^5 +120.*x.^3.*y.^2 +30.*x.*y.^4 -80.*x.^3 -40.*x.*y.^2 +12.*x -60.*x.^3.*y.^2 -60.*x.*y.^4 +40.*x.*y.^2); end                                                                                                                                                                                                                                                                                                                   if n==27; Z=sqrt(2*(6+1))*( +36.*x.^5 +24.*x.^3.*y.^2 -20.*x.^3 -144.*x.^3.*y.^2 -72.*x.*y.^4 +60.*x.*y.^2 +12.*x.*y.^4); end                                                                                                                                                                                                                                                                                                                                       if n==28; Z=sqrt(2*(6+1))*( +6.*x.^5 -60.*x.^3.*y.^2 +30.*x.*y.^4); end                                                                                                                                                                                                                                                                                                                                                                                             if n==29; Z=sqrt(2*(7+1))*( +42.*x.^5.*y -140.*x.^3.*y.^3 +42.*x.*y.^5); end                                                                                                                                                                                                                                                                                                                                                                                        if n==30; Z=sqrt(2*(7+1))*( +210.*x.^5.*y +140.*x.^3.*y.^3 -120.*x.^3.*y -280.*x.^3.*y.^3 -140.*x.*y.^5 +120.*x.*y.^3 +14.*x.*y.^5); end                                                                                                                                                                                                                                                                                                                            if n==31; Z=sqrt(2*(7+1))*( +378.*x.^5.*y +504.*x.^3.*y.^3 +126.*x.*y.^5 -360.*x.^3.*y -180.*x.*y.^3 +60.*x.*y -84.*x.^3.*y.^3 -84.*x.*y.^5 +60.*x.*y.^3); end                                                                                                                                                                                                                                                                                                      if n==32; Z=sqrt(2*(7+1))*( +210.*x.^5.*y +420.*x.^3.*y.^3 +210.*x.*y.^5 -240.*x.^3.*y -240.*x.*y.^3 +60.*x.*y); end                                                                                                                                                                                                                                                                                                                                                if n==33; Z=sqrt(2*(7+1))*( +245.*x.^6 +525.*x.^4.*y.^2 +315.*x.^2.*y.^4 +35.*y.^6 -300.*x.^4 -360.*x.^2.*y.^2 -60.*y.^4 +90.*x.^2 +30.*y.^2 -4); end                                                                                                                                                                                                                                                                                                               if n==34; Z=sqrt(2*(7+1))*( +147.*x.^6 +210.*x.^4.*y.^2 +63.*x.^2.*y.^4 -150.*x.^4 -90.*x.^2.*y.^2 +30.*x.^2 -315.*x.^4.*y.^2 -378.*x.^2.*y.^4 -63.*y.^6 +270.*x.^2.*y.^2 +90.*y.^4 -30.*y.^2); end                                                                                                                                                                                                                                                                 if n==35; Z=sqrt(2*(7+1))*( +49.*x.^6 +35.*x.^4.*y.^2 -30.*x.^4 -350.*x.^4.*y.^2 -210.*x.^2.*y.^4 +180.*x.^2.*y.^2 +105.*x.^2.*y.^4 +35.*y.^6 -30.*y.^4); end                                                                                                                                                                                                                                                                                                       if n==36; Z=sqrt(2*(7+1))*( +7.*x.^6 -105.*x.^4.*y.^2 +105.*x.^2.*y.^4 -7.*y.^6); end                                                                                                                                                                                                                                                                                                                                                                               if n==37; Z=sqrt(2*(8+1))*( +56.*x.^6.*y -280.*x.^4.*y.^3 +168.*x.^2.*y.^5 -8.*y.^7); end                                                                                                                                                                                                                                                                                                                                                                           if n==38; Z=sqrt(2*(8+1))*( +336.*x.^6.*y +240.*x.^4.*y.^3 -210.*x.^4.*y -800.*x.^4.*y.^3 -480.*x.^2.*y.^5 +420.*x.^2.*y.^3 +144.*x.^2.*y.^5 +48.*y.^7 -42.*y.^5); end                                                                                                                                                                                                                                                                                              if n==39; Z=sqrt(2*(8+1))*( +784.*x.^6.*y +1120.*x.^4.*y.^3 +336.*x.^2.*y.^5 -840.*x.^4.*y -504.*x.^2.*y.^3 +180.*x.^2.*y -560.*x.^4.*y.^3 -672.*x.^2.*y.^5 -112.*y.^7 +504.*x.^2.*y.^3 +168.*y.^5 -60.*y.^3); end                                                                                                                                                                                                                                                  if n==40; Z=sqrt(2*(8+1))*( +784.*x.^6.*y +1680.*x.^4.*y.^3 +1008.*x.^2.*y.^5 +112.*y.^7 -1050.*x.^4.*y -1260.*x.^2.*y.^3 -210.*y.^5 +360.*x.^2.*y +120.*y.^3 -20.*y); end                                                                                                                                                                                                                                                                                          if n==41; Z=sqrt(8+1)*( +560.*x.^7 +1680.*x.^5.*y.^2 +1680.*x.^3.*y.^4 +560.*x.*y.^6 -840.*x.^5 -1680.*x.^3.*y.^2 -840.*x.*y.^4 +360.*x.^3 +360.*x.*y.^2 -40.*x); end                                                                                                                                                                                                                                                                                               if n==42; Z=sqrt(2*(8+1))*( +448.*x.^7 +1008.*x.^5.*y.^2 +672.*x.^3.*y.^4 +112.*x.*y.^6 -630.*x.^5 -840.*x.^3.*y.^2 -210.*x.*y.^4 +240.*x.^3 +120.*x.*y.^2 -20.*x -336.*x.^5.*y.^2 -672.*x.^3.*y.^4 -336.*x.*y.^6 +420.*x.^3.*y.^2 +420.*x.*y.^4 -120.*x.*y.^2); end                                                                                                                                                                                                if n==43; Z=sqrt(2*(8+1))*( +224.*x.^7 +336.*x.^5.*y.^2 +112.*x.^3.*y.^4 -252.*x.^5 -168.*x.^3.*y.^2 +60.*x.^3 -1008.*x.^5.*y.^2 -1344.*x.^3.*y.^4 -336.*x.*y.^6 +1008.*x.^3.*y.^2 +504.*x.*y.^4 -180.*x.*y.^2 +112.*x.^3.*y.^4 +112.*x.*y.^6 -84.*x.*y.^4); end                                                                                                                                                                                                    if n==44; Z=sqrt(2*(8+1))*( +64.*x.^7 +48.*x.^5.*y.^2 -42.*x.^5 -720.*x.^5.*y.^2 -480.*x.^3.*y.^4 +420.*x.^3.*y.^2 +480.*x.^3.*y.^4 +240.*x.*y.^6 -210.*x.*y.^4 -16.*x.*y.^6); end                                                                                                                                                                                                                                                                                  if n==45; Z=sqrt(2*(8+1))*( +8.*x.^7 -168.*x.^5.*y.^2 +280.*x.^3.*y.^4 -56.*x.*y.^6); end                                                                                                                                                                                                                                                                                                                                                                           if n==46; Z=sqrt(2*(9+1))*( +72.*x.^7.*y -504.*x.^5.*y.^3 +504.*x.^3.*y.^5 -72.*x.*y.^7); end                                                                                                                                                                                                                                                                                                                                                                       if n==47; Z=sqrt(2*(9+1))*( +504.*x.^7.*y +378.*x.^5.*y.^3 -336.*x.^5.*y -1890.*x.^5.*y.^3 -1260.*x.^3.*y.^5 +1120.*x.^3.*y.^3 +756.*x.^3.*y.^5 +378.*x.*y.^7 -336.*x.*y.^5 -18.*x.*y.^7); end                                                                                                                                                                                                                                                                      if n==48; Z=sqrt(2*(9+1))*( +1440.*x.^7.*y +2160.*x.^5.*y.^3 +720.*x.^3.*y.^5 -1680.*x.^5.*y -1120.*x.^3.*y.^3 +420.*x.^3.*y -2160.*x.^5.*y.^3 -2880.*x.^3.*y.^5 -720.*x.*y.^7 +2240.*x.^3.*y.^3 +1120.*x.*y.^5 -420.*x.*y.^3 +144.*x.^3.*y.^5 +144.*x.*y.^7 -112.*x.*y.^5); end                                                                                                                                                                                    if n==49; Z=sqrt(2*(9+1))*( +2016.*x.^7.*y +4536.*x.^5.*y.^3 +3024.*x.^3.*y.^5 +504.*x.*y.^7 -3024.*x.^5.*y -4032.*x.^3.*y.^3 -1008.*x.*y.^5 +1260.*x.^3.*y +630.*x.*y.^3 -120.*x.*y -504.*x.^5.*y.^3 -1008.*x.^3.*y.^5 -504.*x.*y.^7 +672.*x.^3.*y.^3 +672.*x.*y.^5 -210.*x.*y.^3); end                                                                                                                                                                            if n==50; Z=sqrt(2*(9+1))*( +1008.*x.^7.*y +3024.*x.^5.*y.^3 +3024.*x.^3.*y.^5 +1008.*x.*y.^7 -1680.*x.^5.*y -3360.*x.^3.*y.^3 -1680.*x.*y.^5 +840.*x.^3.*y +840.*x.*y.^3 -120.*x.*y); end                                                                                                                                                                                                                                                                          if n==51; Z=sqrt(2*(9+1))*( +1134.*x.^8 +3528.*x.^6.*y.^2 +3780.*x.^4.*y.^4 +1512.*x.^2.*y.^6 +126.*y.^8 -1960.*x.^6 -4200.*x.^4.*y.^2 -2520.*x.^2.*y.^4 -280.*y.^6 +1050.*x.^4 +1260.*x.^2.*y.^2 +210.*y.^4 -180.*x.^2 -60.*y.^2 +5); end                                                                                                                                                                                                                          if n==52; Z=sqrt(2*(9+1))*( +756.*x.^8 +1764.*x.^6.*y.^2 +1260.*x.^4.*y.^4 +252.*x.^2.*y.^6 -1176.*x.^6 -1680.*x.^4.*y.^2 -504.*x.^2.*y.^4 +525.*x.^4 +315.*x.^2.*y.^2 -60.*x.^2 -1764.*x.^6.*y.^2 -3780.*x.^4.*y.^4 -2268.*x.^2.*y.^6 -252.*y.^8 +2520.*x.^4.*y.^2 +3024.*x.^2.*y.^4 +504.*y.^6 -945.*x.^2.*y.^2 -315.*y.^4 +60.*y.^2); end                                                                                                                        if n==53; Z=sqrt(2*(9+1))*( +324.*x.^8 +504.*x.^6.*y.^2 +180.*x.^4.*y.^4 -392.*x.^6 -280.*x.^4.*y.^2 +105.*x.^4 -2520.*x.^6.*y.^2 -3600.*x.^4.*y.^4 -1080.*x.^2.*y.^6 +2800.*x.^4.*y.^2 +1680.*x.^2.*y.^4 -630.*x.^2.*y.^2 +900.*x.^4.*y.^4 +1080.*x.^2.*y.^6 +180.*y.^8 -840.*x.^2.*y.^4 -280.*y.^6 +105.*y.^4); end                                                                                                                                               if n==54; Z=sqrt(2*(9+1))*( +81.*x.^8 +63.*x.^6.*y.^2 -56.*x.^6 -1323.*x.^6.*y.^2 -945.*x.^4.*y.^4 +840.*x.^4.*y.^2 +1575.*x.^4.*y.^4 +945.*x.^2.*y.^6 -840.*x.^2.*y.^4 -189.*x.^2.*y.^6 -63.*y.^8 +56.*y.^6); end                                                                                                                                                                                                                                                  if n==55; Z=sqrt(2*(9+1))*( +9.*x.^8 -252.*x.^6.*y.^2 +630.*x.^4.*y.^4 -252.*x.^2.*y.^6 +9.*y.^8); end                                                                                                                                                                                                                                                                                                                                                              if n==56; Z=sqrt(2*(10+1))*( +90.*x.^8.*y -840.*x.^6.*y.^3 +1260.*x.^4.*y.^5 -360.*x.^2.*y.^7 +10.*y.^9); end                                                                                                                                                                                                                                                                                                                                                       if n==57; Z=sqrt(2*(10+1))*( +720.*x.^8.*y +560.*x.^6.*y.^3 -504.*x.^6.*y -3920.*x.^6.*y.^3 -2800.*x.^4.*y.^5 +2520.*x.^4.*y.^3 +2800.*x.^4.*y.^5 +1680.*x.^2.*y.^7 -1512.*x.^2.*y.^5 -240.*x.^2.*y.^7 -80.*y.^9 +72.*y.^7); end                                                                                                                                                                                                                                    if n==58; Z=sqrt(2*(10+1))*( +2430.*x.^8.*y +3780.*x.^6.*y.^3 +1350.*x.^4.*y.^5 -3024.*x.^6.*y -2160.*x.^4.*y.^3 +840.*x.^4.*y -6300.*x.^6.*y.^3 -9000.*x.^4.*y.^5 -2700.*x.^2.*y.^7 +7200.*x.^4.*y.^3 +4320.*x.^2.*y.^5 -1680.*x.^2.*y.^3 +1350.*x.^4.*y.^5 +1620.*x.^2.*y.^7 +270.*y.^9 -1296.*x.^2.*y.^5 -432.*y.^7 +168.*y.^5); end                                                                                                                             if n==59; Z=sqrt(2*(10+1))*( +4320.*x.^8.*y +10080.*x.^6.*y.^3 +7200.*x.^4.*y.^5 +1440.*x.^2.*y.^7 -7056.*x.^6.*y -10080.*x.^4.*y.^3 -3024.*x.^2.*y.^5 +3360.*x.^4.*y +2016.*x.^2.*y.^3 -420.*x.^2.*y -3360.*x.^6.*y.^3 -7200.*x.^4.*y.^5 -4320.*x.^2.*y.^7 -480.*y.^9 +5040.*x.^4.*y.^3 +6048.*x.^2.*y.^5 +1008.*y.^7 -2016.*x.^2.*y.^3 -672.*y.^5 +140.*y.^3); end                                                                                                if n==60; Z=sqrt(2*(10+1))*( +3780.*x.^8.*y +11760.*x.^6.*y.^3 +12600.*x.^4.*y.^5 +5040.*x.^2.*y.^7 +420.*y.^9 -7056.*x.^6.*y -15120.*x.^4.*y.^3 -9072.*x.^2.*y.^5 -1008.*y.^7 +4200.*x.^4.*y +5040.*x.^2.*y.^3 +840.*y.^5 -840.*x.^2.*y -280.*y.^3 +30.*y); end                                                                                                                                                                                                    if n==61; Z=sqrt(10+1)*( +2520.*x.^9 +10080.*x.^7.*y.^2 +15120.*x.^5.*y.^4 +10080.*x.^3.*y.^6 +2520.*x.*y.^8 -5040.*x.^7 -15120.*x.^5.*y.^2 -15120.*x.^3.*y.^4 -5040.*x.*y.^6 +3360.*x.^5 +6720.*x.^3.*y.^2 +3360.*x.*y.^4 -840.*x.^3 -840.*x.*y.^2 +60.*x); end                                                                                                                                                                                                    if n==62; Z=sqrt(2*(10+1))*( +2100.*x.^9 +6720.*x.^7.*y.^2 +7560.*x.^5.*y.^4 +3360.*x.^3.*y.^6 +420.*x.*y.^8 -4032.*x.^7 -9072.*x.^5.*y.^2 -6048.*x.^3.*y.^4 -1008.*x.*y.^6 +2520.*x.^5 +3360.*x.^3.*y.^2 +840.*x.*y.^4 -560.*x.^3 -280.*x.*y.^2 +30.*x -1680.*x.^7.*y.^2 -5040.*x.^5.*y.^4 -5040.*x.^3.*y.^6 -1680.*x.*y.^8 +3024.*x.^5.*y.^2 +6048.*x.^3.*y.^4 +3024.*x.*y.^6 -1680.*x.^3.*y.^2 -1680.*x.*y.^4 +280.*x.*y.^2); end                                if n==63; Z=sqrt(2*(10+1))*( +1200.*x.^9 +2880.*x.^7.*y.^2 +2160.*x.^5.*y.^4 +480.*x.^3.*y.^6 -2016.*x.^7 -3024.*x.^5.*y.^2 -1008.*x.^3.*y.^4 +1008.*x.^5 +672.*x.^3.*y.^2 -140.*x.^3 -5760.*x.^7.*y.^2 -12960.*x.^5.*y.^4 -8640.*x.^3.*y.^6 -1440.*x.*y.^8 +9072.*x.^5.*y.^2 +12096.*x.^3.*y.^4 +3024.*x.*y.^6 -4032.*x.^3.*y.^2 -2016.*x.*y.^4 +420.*x.*y.^2 +720.*x.^5.*y.^4 +1440.*x.^3.*y.^6 +720.*x.*y.^8 -1008.*x.^3.*y.^4 -1008.*x.*y.^6 +336.*x.*y.^4); endif n==64; Z=sqrt(2*(10+1))*( +450.*x.^9 +720.*x.^7.*y.^2 +270.*x.^5.*y.^4 -576.*x.^7 -432.*x.^5.*y.^2 +168.*x.^5 -5400.*x.^7.*y.^2 -8100.*x.^5.*y.^4 -2700.*x.^3.*y.^6 +6480.*x.^5.*y.^2 +4320.*x.^3.*y.^4 -1680.*x.^3.*y.^2 +4050.*x.^5.*y.^4 +5400.*x.^3.*y.^6 +1350.*x.*y.^8 -4320.*x.^3.*y.^4 -2160.*x.*y.^6 +840.*x.*y.^4 -180.*x.^3.*y.^6 -180.*x.*y.^8 +144.*x.*y.^6); end                                                                                   if n==65; Z=sqrt(2*(10+1))*( +100.*x.^9 +80.*x.^7.*y.^2 -72.*x.^7 -2240.*x.^7.*y.^2 -1680.*x.^5.*y.^4 +1512.*x.^5.*y.^2 +4200.*x.^5.*y.^4 +2800.*x.^3.*y.^6 -2520.*x.^3.*y.^4 -1120.*x.^3.*y.^6 -560.*x.*y.^8 +504.*x.*y.^6 +20.*x.*y.^8); end                                                                                                                                                                                                                      if n==66; Z=sqrt(2*(10+1))*( +10.*x.^9 -360.*x.^7.*y.^2 +1260.*x.^5.*y.^4 -840.*x.^3.*y.^6 +90.*x.*y.^8); end                                                                                                                                                                                                                                                                                                                                                       elseif pd=='dy'if n==1; Z=zeros(size(x)); endif n==2; Z=sqrt(2*(1+1))*ones(size(x)); end                                                                      if n==3; Z=zeros(size(x)); end                                                                         if n==4; Z=sqrt(2*(2+1))*( +2.*x); end                                                                   if n==5; Z=sqrt(2+1)*( +4.*y); end                                                                       if n==6; Z=sqrt(2*(2+1))*( -2.*y); end                                                                   if n==7; Z=sqrt(2*(3+1))*( +3.*x.^2 -3.*y.^2); end                                                       if n==8; Z=sqrt(2*(3+1))*( +3.*x.^2 +9.*y.^2 -2); end                                                    if n==9; Z=sqrt(2*(3+1))*( +6.*x.*y); end                                                                if n==10; Z=sqrt(2*(3+1))*( -6.*x.*y); end                                                               if n==11; Z=sqrt(2*(4+1))*( +4.*x.^3 -12.*x.*y.^2); end                                                  if n==12; Z=sqrt(2*(4+1))*( +8.*x.^3 +24.*x.*y.^2 -6.*x); end                                            if n==13; Z=sqrt(4+1)*( +24.*x.^2.*y +24.*y.^3 -12.*y); end                                              if n==14; Z=sqrt(2*(4+1))*( +8.*x.^2.*y -8.*x.^2.*y -16.*y.^3 +6.*y); end                                if n==15; Z=sqrt(2*(4+1))*( -12.*x.^2.*y +4.*y.^3); end                                                  if n==16; Z=sqrt(2*(5+1))*( +5.*x.^4 -30.*x.^2.*y.^2 +5.*y.^4); end                                      if n==17; Z=sqrt(2*(5+1))*( +15.*x.^4 +45.*x.^2.*y.^2 -12.*x.^2 -15.*x.^2.*y.^2 -25.*y.^4 +12.*y.^2); endif n==18; Z=sqrt(2*(5+1))*( +10.*x.^4 +60.*x.^2.*y.^2 +50.*y.^4 -12.*x.^2 -36.*y.^2 +3); end             if n==19; Z=sqrt(2*(5+1))*( +40.*x.^3.*y +40.*x.*y.^3 -24.*x.*y); end                                    if n==20; Z=sqrt(2*(5+1))*( +10.*x.^3.*y -30.*x.^3.*y -60.*x.*y.^3 +24.*x.*y); end                       if n==21; Z=sqrt(2*(5+1))*( -20.*x.^3.*y +20.*x.*y.^3); end                                              if n==22; Z=sqrt(2*(6+1))*( +6.*x.^5 -60.*x.^3.*y.^2 +30.*x.*y.^4); end                                                                                                                                                                                                                                                                                                                                                                                             if n==23; Z=sqrt(2*(6+1))*( +24.*x.^5 +72.*x.^3.*y.^2 -20.*x.^3 -72.*x.^3.*y.^2 -120.*x.*y.^4 +60.*x.*y.^2); end                                                                                                                                                                                                                                                                                                                                                    if n==24; Z=sqrt(2*(6+1))*( +30.*x.^5 +180.*x.^3.*y.^2 +150.*x.*y.^4 -40.*x.^3 -120.*x.*y.^2 +12.*x); end                                                                                                                                                                                                                                                                                                                                                           if n==25; Z=sqrt(6+1)*( +120.*x.^4.*y +240.*x.^2.*y.^3 +120.*y.^5 -120.*x.^2.*y -120.*y.^3 +24.*y); end                                                                                                                                                                                                                                                                                                                                                             if n==26; Z=sqrt(2*(6+1))*( +60.*x.^4.*y +60.*x.^2.*y.^3 -40.*x.^2.*y -30.*x.^4.*y -120.*x.^2.*y.^3 -90.*y.^5 +40.*x.^2.*y +80.*y.^3 -12.*y); end                                                                                                                                                                                                                                                                                                                   if n==27; Z=sqrt(2*(6+1))*( +12.*x.^4.*y -72.*x.^4.*y -144.*x.^2.*y.^3 +60.*x.^2.*y +24.*x.^2.*y.^3 +36.*y.^5 -20.*y.^3); end                                                                                                                                                                                                                                                                                                                                       if n==28; Z=sqrt(2*(6+1))*( -30.*x.^4.*y +60.*x.^2.*y.^3 -6.*y.^5); end                                                                                                                                                                                                                                                                                                                                                                                             if n==29; Z=sqrt(2*(7+1))*( +7.*x.^6 -105.*x.^4.*y.^2 +105.*x.^2.*y.^4 -7.*y.^6); end                                                                                                                                                                                                                                                                                                                                                                               if n==30; Z=sqrt(2*(7+1))*( +35.*x.^6 +105.*x.^4.*y.^2 -30.*x.^4 -210.*x.^4.*y.^2 -350.*x.^2.*y.^4 +180.*x.^2.*y.^2 +35.*x.^2.*y.^4 +49.*y.^6 -30.*y.^4); end                                                                                                                                                                                                                                                                                                       if n==31; Z=sqrt(2*(7+1))*( +63.*x.^6 +378.*x.^4.*y.^2 +315.*x.^2.*y.^4 -90.*x.^4 -270.*x.^2.*y.^2 +30.*x.^2 -63.*x.^4.*y.^2 -210.*x.^2.*y.^4 -147.*y.^6 +90.*x.^2.*y.^2 +150.*y.^4 -30.*y.^2); end                                                                                                                                                                                                                                                                 if n==32; Z=sqrt(2*(7+1))*( +35.*x.^6 +315.*x.^4.*y.^2 +525.*x.^2.*y.^4 +245.*y.^6 -60.*x.^4 -360.*x.^2.*y.^2 -300.*y.^4 +30.*x.^2 +90.*y.^2 -4); end                                                                                                                                                                                                                                                                                                               if n==33; Z=sqrt(2*(7+1))*( +210.*x.^5.*y +420.*x.^3.*y.^3 +210.*x.*y.^5 -240.*x.^3.*y -240.*x.*y.^3 +60.*x.*y); end                                                                                                                                                                                                                                                                                                                                                if n==34; Z=sqrt(2*(7+1))*( +84.*x.^5.*y +84.*x.^3.*y.^3 -60.*x.^3.*y -126.*x.^5.*y -504.*x.^3.*y.^3 -378.*x.*y.^5 +180.*x.^3.*y +360.*x.*y.^3 -60.*x.*y); end                                                                                                                                                                                                                                                                                                      if n==35; Z=sqrt(2*(7+1))*( +14.*x.^5.*y -140.*x.^5.*y -280.*x.^3.*y.^3 +120.*x.^3.*y +140.*x.^3.*y.^3 +210.*x.*y.^5 -120.*x.*y.^3); end                                                                                                                                                                                                                                                                                                                            if n==36; Z=sqrt(2*(7+1))*( -42.*x.^5.*y +140.*x.^3.*y.^3 -42.*x.*y.^5); end                                                                                                                                                                                                                                                                                                                                                                                        if n==37; Z=sqrt(2*(8+1))*( +8.*x.^7 -168.*x.^5.*y.^2 +280.*x.^3.*y.^4 -56.*x.*y.^6); end                                                                                                                                                                                                                                                                                                                                                                           if n==38; Z=sqrt(2*(8+1))*( +48.*x.^7 +144.*x.^5.*y.^2 -42.*x.^5 -480.*x.^5.*y.^2 -800.*x.^3.*y.^4 +420.*x.^3.*y.^2 +240.*x.^3.*y.^4 +336.*x.*y.^6 -210.*x.*y.^4); end                                                                                                                                                                                                                                                                                              if n==39; Z=sqrt(2*(8+1))*( +112.*x.^7 +672.*x.^5.*y.^2 +560.*x.^3.*y.^4 -168.*x.^5 -504.*x.^3.*y.^2 +60.*x.^3 -336.*x.^5.*y.^2 -1120.*x.^3.*y.^4 -784.*x.*y.^6 +504.*x.^3.*y.^2 +840.*x.*y.^4 -180.*x.*y.^2); end                                                                                                                                                                                                                                                  if n==40; Z=sqrt(2*(8+1))*( +112.*x.^7 +1008.*x.^5.*y.^2 +1680.*x.^3.*y.^4 +784.*x.*y.^6 -210.*x.^5 -1260.*x.^3.*y.^2 -1050.*x.*y.^4 +120.*x.^3 +360.*x.*y.^2 -20.*x); end                                                                                                                                                                                                                                                                                          if n==41; Z=sqrt(8+1)*( +560.*x.^6.*y +1680.*x.^4.*y.^3 +1680.*x.^2.*y.^5 +560.*y.^7 -840.*x.^4.*y -1680.*x.^2.*y.^3 -840.*y.^5 +360.*x.^2.*y +360.*y.^3 -40.*y); end                                                                                                                                                                                                                                                                                               if n==42; Z=sqrt(2*(8+1))*( +336.*x.^6.*y +672.*x.^4.*y.^3 +336.*x.^2.*y.^5 -420.*x.^4.*y -420.*x.^2.*y.^3 +120.*x.^2.*y -112.*x.^6.*y -672.*x.^4.*y.^3 -1008.*x.^2.*y.^5 -448.*y.^7 +210.*x.^4.*y +840.*x.^2.*y.^3 +630.*y.^5 -120.*x.^2.*y -240.*y.^3 +20.*y); end                                                                                                                                                                                                if n==43; Z=sqrt(2*(8+1))*( +112.*x.^6.*y +112.*x.^4.*y.^3 -84.*x.^4.*y -336.*x.^6.*y -1344.*x.^4.*y.^3 -1008.*x.^2.*y.^5 +504.*x.^4.*y +1008.*x.^2.*y.^3 -180.*x.^2.*y +112.*x.^4.*y.^3 +336.*x.^2.*y.^5 +224.*y.^7 -168.*x.^2.*y.^3 -252.*y.^5 +60.*y.^3); end                                                                                                                                                                                                    if n==44; Z=sqrt(2*(8+1))*( +16.*x.^6.*y -240.*x.^6.*y -480.*x.^4.*y.^3 +210.*x.^4.*y +480.*x.^4.*y.^3 +720.*x.^2.*y.^5 -420.*x.^2.*y.^3 -48.*x.^2.*y.^5 -64.*y.^7 +42.*y.^5); end                                                                                                                                                                                                                                                                                  if n==45; Z=sqrt(2*(8+1))*( -56.*x.^6.*y +280.*x.^4.*y.^3 -168.*x.^2.*y.^5 +8.*y.^7); end                                                                                                                                                                                                                                                                                                                                                                           if n==46; Z=sqrt(2*(9+1))*( +9.*x.^8 -252.*x.^6.*y.^2 +630.*x.^4.*y.^4 -252.*x.^2.*y.^6 +9.*y.^8); end                                                                                                                                                                                                                                                                                                                                                              if n==47; Z=sqrt(2*(9+1))*( +63.*x.^8 +189.*x.^6.*y.^2 -56.*x.^6 -945.*x.^6.*y.^2 -1575.*x.^4.*y.^4 +840.*x.^4.*y.^2 +945.*x.^4.*y.^4 +1323.*x.^2.*y.^6 -840.*x.^2.*y.^4 -63.*x.^2.*y.^6 -81.*y.^8 +56.*y.^6); end                                                                                                                                                                                                                                                  if n==48; Z=sqrt(2*(9+1))*( +180.*x.^8 +1080.*x.^6.*y.^2 +900.*x.^4.*y.^4 -280.*x.^6 -840.*x.^4.*y.^2 +105.*x.^4 -1080.*x.^6.*y.^2 -3600.*x.^4.*y.^4 -2520.*x.^2.*y.^6 +1680.*x.^4.*y.^2 +2800.*x.^2.*y.^4 -630.*x.^2.*y.^2 +180.*x.^4.*y.^4 +504.*x.^2.*y.^6 +324.*y.^8 -280.*x.^2.*y.^4 -392.*y.^6 +105.*y.^4); end                                                                                                                                               if n==49; Z=sqrt(2*(9+1))*( +252.*x.^8 +2268.*x.^6.*y.^2 +3780.*x.^4.*y.^4 +1764.*x.^2.*y.^6 -504.*x.^6 -3024.*x.^4.*y.^2 -2520.*x.^2.*y.^4 +315.*x.^4 +945.*x.^2.*y.^2 -60.*x.^2 -252.*x.^6.*y.^2 -1260.*x.^4.*y.^4 -1764.*x.^2.*y.^6 -756.*y.^8 +504.*x.^4.*y.^2 +1680.*x.^2.*y.^4 +1176.*y.^6 -315.*x.^2.*y.^2 -525.*y.^4 +60.*y.^2); end                                                                                                                        if n==50; Z=sqrt(2*(9+1))*( +126.*x.^8 +1512.*x.^6.*y.^2 +3780.*x.^4.*y.^4 +3528.*x.^2.*y.^6 +1134.*y.^8 -280.*x.^6 -2520.*x.^4.*y.^2 -4200.*x.^2.*y.^4 -1960.*y.^6 +210.*x.^4 +1260.*x.^2.*y.^2 +1050.*y.^4 -60.*x.^2 -180.*y.^2 +5); end                                                                                                                                                                                                                          if n==51; Z=sqrt(2*(9+1))*( +1008.*x.^7.*y +3024.*x.^5.*y.^3 +3024.*x.^3.*y.^5 +1008.*x.*y.^7 -1680.*x.^5.*y -3360.*x.^3.*y.^3 -1680.*x.*y.^5 +840.*x.^3.*y +840.*x.*y.^3 -120.*x.*y); end                                                                                                                                                                                                                                                                          if n==52; Z=sqrt(2*(9+1))*( +504.*x.^7.*y +1008.*x.^5.*y.^3 +504.*x.^3.*y.^5 -672.*x.^5.*y -672.*x.^3.*y.^3 +210.*x.^3.*y -504.*x.^7.*y -3024.*x.^5.*y.^3 -4536.*x.^3.*y.^5 -2016.*x.*y.^7 +1008.*x.^5.*y +4032.*x.^3.*y.^3 +3024.*x.*y.^5 -630.*x.^3.*y -1260.*x.*y.^3 +120.*x.*y); end                                                                                                                                                                            if n==53; Z=sqrt(2*(9+1))*( +144.*x.^7.*y +144.*x.^5.*y.^3 -112.*x.^5.*y -720.*x.^7.*y -2880.*x.^5.*y.^3 -2160.*x.^3.*y.^5 +1120.*x.^5.*y +2240.*x.^3.*y.^3 -420.*x.^3.*y +720.*x.^5.*y.^3 +2160.*x.^3.*y.^5 +1440.*x.*y.^7 -1120.*x.^3.*y.^3 -1680.*x.*y.^5 +420.*x.*y.^3); end                                                                                                                                                                                    if n==54; Z=sqrt(2*(9+1))*( +18.*x.^7.*y -378.*x.^7.*y -756.*x.^5.*y.^3 +336.*x.^5.*y +1260.*x.^5.*y.^3 +1890.*x.^3.*y.^5 -1120.*x.^3.*y.^3 -378.*x.^3.*y.^5 -504.*x.*y.^7 +336.*x.*y.^5); end                                                                                                                                                                                                                                                                      if n==55; Z=sqrt(2*(9+1))*( -72.*x.^7.*y +504.*x.^5.*y.^3 -504.*x.^3.*y.^5 +72.*x.*y.^7); end                                                                                                                                                                                                                                                                                                                                                                       if n==56; Z=sqrt(2*(10+1))*( +10.*x.^9 -360.*x.^7.*y.^2 +1260.*x.^5.*y.^4 -840.*x.^3.*y.^6 +90.*x.*y.^8); end                                                                                                                                                                                                                                                                                                                                                       if n==57; Z=sqrt(2*(10+1))*( +80.*x.^9 +240.*x.^7.*y.^2 -72.*x.^7 -1680.*x.^7.*y.^2 -2800.*x.^5.*y.^4 +1512.*x.^5.*y.^2 +2800.*x.^5.*y.^4 +3920.*x.^3.*y.^6 -2520.*x.^3.*y.^4 -560.*x.^3.*y.^6 -720.*x.*y.^8 +504.*x.*y.^6); end                                                                                                                                                                                                                                    if n==58; Z=sqrt(2*(10+1))*( +270.*x.^9 +1620.*x.^7.*y.^2 +1350.*x.^5.*y.^4 -432.*x.^7 -1296.*x.^5.*y.^2 +168.*x.^5 -2700.*x.^7.*y.^2 -9000.*x.^5.*y.^4 -6300.*x.^3.*y.^6 +4320.*x.^5.*y.^2 +7200.*x.^3.*y.^4 -1680.*x.^3.*y.^2 +1350.*x.^5.*y.^4 +3780.*x.^3.*y.^6 +2430.*x.*y.^8 -2160.*x.^3.*y.^4 -3024.*x.*y.^6 +840.*x.*y.^4); end                                                                                                                             if n==59; Z=sqrt(2*(10+1))*( +480.*x.^9 +4320.*x.^7.*y.^2 +7200.*x.^5.*y.^4 +3360.*x.^3.*y.^6 -1008.*x.^7 -6048.*x.^5.*y.^2 -5040.*x.^3.*y.^4 +672.*x.^5 +2016.*x.^3.*y.^2 -140.*x.^3 -1440.*x.^7.*y.^2 -7200.*x.^5.*y.^4 -10080.*x.^3.*y.^6 -4320.*x.*y.^8 +3024.*x.^5.*y.^2 +10080.*x.^3.*y.^4 +7056.*x.*y.^6 -2016.*x.^3.*y.^2 -3360.*x.*y.^4 +420.*x.*y.^2); end                                                                                                if n==60; Z=sqrt(2*(10+1))*( +420.*x.^9 +5040.*x.^7.*y.^2 +12600.*x.^5.*y.^4 +11760.*x.^3.*y.^6 +3780.*x.*y.^8 -1008.*x.^7 -9072.*x.^5.*y.^2 -15120.*x.^3.*y.^4 -7056.*x.*y.^6 +840.*x.^5 +5040.*x.^3.*y.^2 +4200.*x.*y.^4 -280.*x.^3 -840.*x.*y.^2 +30.*x); end                                                                                                                                                                                                    if n==61; Z=sqrt(10+1)*( +2520.*x.^8.*y +10080.*x.^6.*y.^3 +15120.*x.^4.*y.^5 +10080.*x.^2.*y.^7 +2520.*y.^9 -5040.*x.^6.*y -15120.*x.^4.*y.^3 -15120.*x.^2.*y.^5 -5040.*y.^7 +3360.*x.^4.*y +6720.*x.^2.*y.^3 +3360.*y.^5 -840.*x.^2.*y -840.*y.^3 +60.*y); end                                                                                                                                                                                                    if n==62; Z=sqrt(2*(10+1))*( +1680.*x.^8.*y +5040.*x.^6.*y.^3 +5040.*x.^4.*y.^5 +1680.*x.^2.*y.^7 -3024.*x.^6.*y -6048.*x.^4.*y.^3 -3024.*x.^2.*y.^5 +1680.*x.^4.*y +1680.*x.^2.*y.^3 -280.*x.^2.*y -420.*x.^8.*y -3360.*x.^6.*y.^3 -7560.*x.^4.*y.^5 -6720.*x.^2.*y.^7 -2100.*y.^9 +1008.*x.^6.*y +6048.*x.^4.*y.^3 +9072.*x.^2.*y.^5 +4032.*y.^7 -840.*x.^4.*y -3360.*x.^2.*y.^3 -2520.*y.^5 +280.*x.^2.*y +560.*y.^3 -30.*y); end                                if n==63; Z=sqrt(2*(10+1))*( +720.*x.^8.*y +1440.*x.^6.*y.^3 +720.*x.^4.*y.^5 -1008.*x.^6.*y -1008.*x.^4.*y.^3 +336.*x.^4.*y -1440.*x.^8.*y -8640.*x.^6.*y.^3 -12960.*x.^4.*y.^5 -5760.*x.^2.*y.^7 +3024.*x.^6.*y +12096.*x.^4.*y.^3 +9072.*x.^2.*y.^5 -2016.*x.^4.*y -4032.*x.^2.*y.^3 +420.*x.^2.*y +480.*x.^6.*y.^3 +2160.*x.^4.*y.^5 +2880.*x.^2.*y.^7 +1200.*y.^9 -1008.*x.^4.*y.^3 -3024.*x.^2.*y.^5 -2016.*y.^7 +672.*x.^2.*y.^3 +1008.*y.^5 -140.*y.^3); endif n==64; Z=sqrt(2*(10+1))*( +180.*x.^8.*y +180.*x.^6.*y.^3 -144.*x.^6.*y -1350.*x.^8.*y -5400.*x.^6.*y.^3 -4050.*x.^4.*y.^5 +2160.*x.^6.*y +4320.*x.^4.*y.^3 -840.*x.^4.*y +2700.*x.^6.*y.^3 +8100.*x.^4.*y.^5 +5400.*x.^2.*y.^7 -4320.*x.^4.*y.^3 -6480.*x.^2.*y.^5 +1680.*x.^2.*y.^3 -270.*x.^4.*y.^5 -720.*x.^2.*y.^7 -450.*y.^9 +432.*x.^2.*y.^5 +576.*y.^7 -168.*y.^5); end                                                                                   if n==65; Z=sqrt(2*(10+1))*( +20.*x.^8.*y -560.*x.^8.*y -1120.*x.^6.*y.^3 +504.*x.^6.*y +2800.*x.^6.*y.^3 +4200.*x.^4.*y.^5 -2520.*x.^4.*y.^3 -1680.*x.^4.*y.^5 -2240.*x.^2.*y.^7 +1512.*x.^2.*y.^5 +80.*x.^2.*y.^7 +100.*y.^9 -72.*y.^7); end                                                                                                                                                                                                                      if n==66; Z=sqrt(2*(10+1))*( -90.*x.^8.*y +840.*x.^6.*y.^3 -1260.*x.^4.*y.^5 +360.*x.^2.*y.^7 -10.*y.^9); end                                                                                                                                                                                                                                                                                                                                                       end% end of function ZernikeR