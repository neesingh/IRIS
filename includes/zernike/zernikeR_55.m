function Z = zernikeR_55(x,y,pd)%ZernikeR   Evaluate Zernike circle polynomial of modes 1-66 for sample points%			specified in RECTANGULAR coordinates.%%  Use: Z = zernikeR(x,y,pd)%%	Z=zernike(x,y,pd) returns matrix Z filled with samples of the Zernike %	polynomials for all mode up to N=66 (10th order). %%	NOTE: This version exchanges x&y in Malacara's formulas in order to obey % 	the standard mathematical convention that x=r*cos(theta), y=r*sin(theta).%	Equations were generated automatically by Make_N_OrdersR. %%	Input arguments:%		x,y are scalars, vectors, or matrices specifying the sample points  %		  upon which the Zernike functions are to be evaluated.%		x and y must be normalised coordinates inside the unit circle.%	%		pd is optional. Valid values of pd are 'dx' or 'dy' or 'h'%		  'dx' evaluates the partial derivative of the Zernike with respect to x%	 	  'dy' evaluates the partial derivative of the Zernike with respect to y%		  'h' evaluates the surface height (i.e. same as if pd were omitted)%%	Output Z is a vector or matrix of the same size as x and y.%%	LNT 8-Mar-98. Do orders 0-5.  %	LNT 9-Mar-98  Add orders 6-10.%	LNT 9-Mar-98. Redo the lot, this time with normalization constants included.%					The result should be a set of orthonormal functions.%	LNT 14-Mar-98  Redo the lot, with numbering scheme: mode 1= constant (piston).%	KMH 6-Mar-2000  Calc all 66 modes, remove n as input arg. Calc all powers%                   x^n, y^n at the beginning, and replace power calls x^n, y^n %                   in later code with x_n and y_n respectively.%% © 1998 Larry Thibos, 2000 Kevin Haggerty, Indiana Universitynarginchk(2,3);if nargin==3,	pd=lower(pd);	if  pd~='dx' & pd~='dy' & pd~='h'	error('Only valid values for pd are dx, dy, and h.');	endendif size(x)~=size(y)	error('x and y must have the same size.'); endx_2 = x.^2;x_3 = x.^3;x_4 = x.^4;x_5 = x.^5;x_6 = x.^6;x_7 = x.^7;x_8 = x.^8;x_9 = x.^9;y_2 = y.^2;y_3 = y.^3;y_4 = y.^4;y_5 = y.^5;y_6 = y.^6;y_7 = y.^7;y_8 = y.^8;y_9 = y.^9;Z = zeros(size(x,1), size(x,2), 66);if nargin==2 | pd=='h'Z(:,:,1)= ones(size(x));                                                                          Z(:,:,2)=sqrt(2*(1+1))*( +1.*y);                                                                       Z(:,:,3)=sqrt(2*(1+1))*( +1.*x);                                                                       Z(:,:,4)=sqrt(2*(2+1))*( +2.*x.*y);                                                                    Z(:,:,5)=sqrt(2+1)*( +2.*x_2 +2.*y_2 -1);                                                            Z(:,:,6)=sqrt(2*(2+1))*( +1.*x_2 -1.*y_2);                                                           Z(:,:,7)=sqrt(2*(3+1))*( +3.*x_2.*y -1.*y_3);                                                        Z(:,:,8)=sqrt(2*(3+1))*( +3.*x_2.*y +3.*y_3 -2.*y);                                                  Z(:,:,9)=sqrt(2*(3+1))*( +3.*x_3 +3.*x.*y_2 -2.*x);                                                  Z(:,:,10)=sqrt(2*(3+1))*( +1.*x_3 -3.*x.*y_2);                                                       Z(:,:,11)=sqrt(2*(4+1))*( +4.*x_3.*y -4.*x.*y_3);                                                    Z(:,:,12)=sqrt(2*(4+1))*( +8.*x_3.*y +8.*x.*y_3 -6.*x.*y);                                           Z(:,:,13)=sqrt(4+1)*( +6.*x_4 +12.*x_2.*y_2 +6.*y_4 -6.*x_2 -6.*y_2 +1);                         Z(:,:,14)=sqrt(2*(4+1))*( +4.*x_4 +4.*x_2.*y_2 -3.*x_2 -4.*x_2.*y_2 -4.*y_4 +3.*y_2);          Z(:,:,15)=sqrt(2*(4+1))*( +1.*x_4 -6.*x_2.*y_2 +1.*y_4);                                           Z(:,:,16)=sqrt(2*(5+1))*( +5.*x_4.*y -10.*x_2.*y_3 +1.*y_5);                                       Z(:,:,17)=sqrt(2*(5+1))*( +15.*x_4.*y +15.*x_2.*y_3 -12.*x_2.*y -5.*x_2.*y_3 -5.*y_5 +4.*y_3); Z(:,:,18)=sqrt(2*(5+1))*( +10.*x_4.*y +20.*x_2.*y_3 +10.*y_5 -12.*x_2.*y -12.*y_3 +3.*y);        Z(:,:,19)=sqrt(2*(5+1))*( +10.*x_5 +20.*x_3.*y_2 +10.*x.*y_4 -12.*x_3 -12.*x.*y_2 +3.*x);        Z(:,:,20)=sqrt(2*(5+1))*( +5.*x_5 +5.*x_3.*y_2 -4.*x_3 -15.*x_3.*y_2 -15.*x.*y_4 +12.*x.*y_2); Z(:,:,21)=sqrt(2*(5+1))*( +1.*x_5 -10.*x_3.*y_2 +5.*x.*y_4);                                       Z(:,:,22)=sqrt(2*(6+1))*( +6.*x_5.*y -20.*x_3.*y_3 +6.*x.*y_5);                                                                                                                                                                                                                                                                                                                                                                                                                                               Z(:,:,23)=sqrt(2*(6+1))*( +24.*x_5.*y +24.*x_3.*y_3 -20.*x_3.*y -24.*x_3.*y_3 -24.*x.*y_5 +20.*x.*y_3);                                                                                                                                                                                                                                                                                                                                                                                                   Z(:,:,24)=sqrt(2*(6+1))*( +30.*x_5.*y +60.*x_3.*y_3 +30.*x.*y_5 -40.*x_3.*y -40.*x.*y_3 +12.*x.*y);                                                                                                                                                                                                                                                                                                                                                                                                         Z(:,:,25)=sqrt(6+1)*( +20.*x_6 +60.*x_4.*y_2 +60.*x_2.*y_4 +20.*y_6 -30.*x_4 -60.*x_2.*y_2 -30.*y_4 +12.*x_2 +12.*y_2 -1);                                                                                                                                                                                                                                                                                                                                                                            Z(:,:,26)=sqrt(2*(6+1))*( +15.*x_6 +30.*x_4.*y_2 +15.*x_2.*y_4 -20.*x_4 -20.*x_2.*y_2 +6.*x_2 -15.*x_4.*y_2 -30.*x_2.*y_4 -15.*y_6 +20.*x_2.*y_2 +20.*y_4 -6.*y_2);                                                                                                                                                                                                                                                                                                                             Z(:,:,27)=sqrt(2*(6+1))*( +6.*x_6 +6.*x_4.*y_2 -5.*x_4 -36.*x_4.*y_2 -36.*x_2.*y_4 +30.*x_2.*y_2 +6.*x_2.*y_4 +6.*y_6 -5.*y_4);                                                                                                                                                                                                                                                                                                                                                                     Z(:,:,28)=sqrt(2*(6+1))*( +1.*x_6 -15.*x_4.*y_2 +15.*x_2.*y_4 -1.*y_6);                                                                                                                                                                                                                                                                                                                                                                                                                                     Z(:,:,29)=sqrt(2*(7+1))*( +7.*x_6.*y -35.*x_4.*y_3 +21.*x_2.*y_5 -1.*y_7);                                                                                                                                                                                                                                                                                                                                                                                                                                  Z(:,:,30)=sqrt(2*(7+1))*( +35.*x_6.*y +35.*x_4.*y_3 -30.*x_4.*y -70.*x_4.*y_3 -70.*x_2.*y_5 +60.*x_2.*y_3 +7.*x_2.*y_5 +7.*y_7 -6.*y_5);                                                                                                                                                                                                                                                                                                                                                            Z(:,:,31)=sqrt(2*(7+1))*( +63.*x_6.*y +126.*x_4.*y_3 +63.*x_2.*y_5 -90.*x_4.*y -90.*x_2.*y_3 +30.*x_2.*y -21.*x_4.*y_3 -42.*x_2.*y_5 -21.*y_7 +30.*x_2.*y_3 +30.*y_5 -10.*y_3);                                                                                                                                                                                                                                                                                                                 Z(:,:,32)=sqrt(2*(7+1))*( +35.*x_6.*y +105.*x_4.*y_3 +105.*x_2.*y_5 +35.*y_7 -60.*x_4.*y -120.*x_2.*y_3 -60.*y_5 +30.*x_2.*y +30.*y_3 -4.*y);                                                                                                                                                                                                                                                                                                                                                         Z(:,:,33)=sqrt(2*(7+1))*( +35.*x_7 +105.*x_5.*y_2 +105.*x_3.*y_4 +35.*x.*y_6 -60.*x_5 -120.*x_3.*y_2 -60.*x.*y_4 +30.*x_3 +30.*x.*y_2 -4.*x);                                                                                                                                                                                                                                                                                                                                                         Z(:,:,34)=sqrt(2*(7+1))*( +21.*x_7 +42.*x_5.*y_2 +21.*x_3.*y_4 -30.*x_5 -30.*x_3.*y_2 +10.*x_3 -63.*x_5.*y_2 -126.*x_3.*y_4 -63.*x.*y_6 +90.*x_3.*y_2 +90.*x.*y_4 -30.*x.*y_2);                                                                                                                                                                                                                                                                                                                 Z(:,:,35)=sqrt(2*(7+1))*( +7.*x_7 +7.*x_5.*y_2 -6.*x_5 -70.*x_5.*y_2 -70.*x_3.*y_4 +60.*x_3.*y_2 +35.*x_3.*y_4 +35.*x.*y_6 -30.*x.*y_4);                                                                                                                                                                                                                                                                                                                                                            Z(:,:,36)=sqrt(2*(7+1))*( +1.*x_7 -21.*x_5.*y_2 +35.*x_3.*y_4 -7.*x.*y_6);                                                                                                                                                                                                                                                                                                                                                                                                                                  Z(:,:,37)=sqrt(2*(8+1))*( +8.*x_7.*y -56.*x_5.*y_3 +56.*x_3.*y_5 -8.*x.*y_7);                                                                                                                                                                                                                                                                                                                                                                                                                               Z(:,:,38)=sqrt(2*(8+1))*( +48.*x_7.*y +48.*x_5.*y_3 -42.*x_5.*y -160.*x_5.*y_3 -160.*x_3.*y_5 +140.*x_3.*y_3 +48.*x_3.*y_5 +48.*x.*y_7 -42.*x.*y_5);                                                                                                                                                                                                                                                                                                                                                Z(:,:,39)=sqrt(2*(8+1))*( +112.*x_7.*y +224.*x_5.*y_3 +112.*x_3.*y_5 -168.*x_5.*y -168.*x_3.*y_3 +60.*x_3.*y -112.*x_5.*y_3 -224.*x_3.*y_5 -112.*x.*y_7 +168.*x_3.*y_3 +168.*x.*y_5 -60.*x.*y_3);                                                                                                                                                                                                                                                                                               Z(:,:,40)=sqrt(2*(8+1))*( +112.*x_7.*y +336.*x_5.*y_3 +336.*x_3.*y_5 +112.*x.*y_7 -210.*x_5.*y -420.*x_3.*y_3 -210.*x.*y_5 +120.*x_3.*y +120.*x.*y_3 -20.*x.*y);                                                                                                                                                                                                                                                                                                                                      Z(:,:,41)=sqrt(8+1)*( +70.*x_8 +280.*x_6.*y_2 +420.*x_4.*y_4 +280.*x_2.*y_6 +70.*y_8 -140.*x_6 -420.*x_4.*y_2 -420.*x_2.*y_4 -140.*y_6 +90.*x_4 +180.*x_2.*y_2 +90.*y_4 -20.*x_2 -20.*y_2 +1);                                                                                                                                                                                                                                                                                                Z(:,:,42)=sqrt(2*(8+1))*( +56.*x_8 +168.*x_6.*y_2 +168.*x_4.*y_4 +56.*x_2.*y_6 -105.*x_6 -210.*x_4.*y_2 -105.*x_2.*y_4 +60.*x_4 +60.*x_2.*y_2 -10.*x_2 -56.*x_6.*y_2 -168.*x_4.*y_4 -168.*x_2.*y_6 -56.*y_8 +105.*x_4.*y_2 +210.*x_2.*y_4 +105.*y_6 -60.*x_2.*y_2 -60.*y_4 +10.*y_2);                                                                                                                                                                                             Z(:,:,43)=sqrt(2*(8+1))*( +28.*x_8 +56.*x_6.*y_2 +28.*x_4.*y_4 -42.*x_6 -42.*x_4.*y_2 +15.*x_4 -168.*x_6.*y_2 -336.*x_4.*y_4 -168.*x_2.*y_6 +252.*x_4.*y_2 +252.*x_2.*y_4 -90.*x_2.*y_2 +28.*x_4.*y_4 +56.*x_2.*y_6 +28.*y_8 -42.*x_2.*y_4 -42.*y_6 +15.*y_4);                                                                                                                                                                                                                      Z(:,:,44)=sqrt(2*(8+1))*( +8.*x_8 +8.*x_6.*y_2 -7.*x_6 -120.*x_6.*y_2 -120.*x_4.*y_4 +105.*x_4.*y_2 +120.*x_4.*y_4 +120.*x_2.*y_6 -105.*x_2.*y_4 -8.*x_2.*y_6 -8.*y_8 +7.*y_6);                                                                                                                                                                                                                                                                                                               Z(:,:,45)=sqrt(2*(8+1))*( +1.*x_8 -28.*x_6.*y_2 +70.*x_4.*y_4 -28.*x_2.*y_6 +1.*y_8);                                                                                                                                                                                                                                                                                                                                                                                                                     Z(:,:,46)=sqrt(2*(9+1))*( +9.*x_8.*y -84.*x_6.*y_3 +126.*x_4.*y_5 -36.*x_2.*y_7 +1.*y_9);                                                                                                                                                                                                                                                                                                                                                                                                                 Z(:,:,47)=sqrt(2*(9+1))*( +63.*x_8.*y +63.*x_6.*y_3 -56.*x_6.*y -315.*x_6.*y_3 -315.*x_4.*y_5 +280.*x_4.*y_3 +189.*x_4.*y_5 +189.*x_2.*y_7 -168.*x_2.*y_5 -9.*x_2.*y_7 -9.*y_9 +8.*y_7);                                                                                                                                                                                                                                                                                                      Z(:,:,48)=sqrt(2*(9+1))*( +180.*x_8.*y +360.*x_6.*y_3 +180.*x_4.*y_5 -280.*x_6.*y -280.*x_4.*y_3 +105.*x_4.*y -360.*x_6.*y_3 -720.*x_4.*y_5 -360.*x_2.*y_7 +560.*x_4.*y_3 +560.*x_2.*y_5 -210.*x_2.*y_3 +36.*x_4.*y_5 +72.*x_2.*y_7 +36.*y_9 -56.*x_2.*y_5 -56.*y_7 +21.*y_5);                                                                                                                                                                                                      Z(:,:,49)=sqrt(2*(9+1))*( +252.*x_8.*y +756.*x_6.*y_3 +756.*x_4.*y_5 +252.*x_2.*y_7 -504.*x_6.*y -1008.*x_4.*y_3 -504.*x_2.*y_5 +315.*x_4.*y +315.*x_2.*y_3 -60.*x_2.*y -84.*x_6.*y_3 -252.*x_4.*y_5 -252.*x_2.*y_7 -84.*y_9 +168.*x_4.*y_3 +336.*x_2.*y_5 +168.*y_7 -105.*x_2.*y_3 -105.*y_5 +20.*y_3);                                                                                                                                                                          Z(:,:,50)=sqrt(2*(9+1))*( +126.*x_8.*y +504.*x_6.*y_3 +756.*x_4.*y_5 +504.*x_2.*y_7 +126.*y_9 -280.*x_6.*y -840.*x_4.*y_3 -840.*x_2.*y_5 -280.*y_7 +210.*x_4.*y +420.*x_2.*y_3 +210.*y_5 -60.*x_2.*y -60.*y_3 +5.*y);                                                                                                                                                                                                                                                                         Z(:,:,51)=sqrt(2*(9+1))*( +126.*x_9 +504.*x_7.*y_2 +756.*x_5.*y_4 +504.*x_3.*y_6 +126.*x.*y_8 -280.*x_7 -840.*x_5.*y_2 -840.*x_3.*y_4 -280.*x.*y_6 +210.*x_5 +420.*x_3.*y_2 +210.*x.*y_4 -60.*x_3 -60.*x.*y_2 +5.*x);                                                                                                                                                                                                                                                                         Z(:,:,52)=sqrt(2*(9+1))*( +84.*x_9 +252.*x_7.*y_2 +252.*x_5.*y_4 +84.*x_3.*y_6 -168.*x_7 -336.*x_5.*y_2 -168.*x_3.*y_4 +105.*x_5 +105.*x_3.*y_2 -20.*x_3 -252.*x_7.*y_2 -756.*x_5.*y_4 -756.*x_3.*y_6 -252.*x.*y_8 +504.*x_5.*y_2 +1008.*x_3.*y_4 +504.*x.*y_6 -315.*x_3.*y_2 -315.*x.*y_4 +60.*x.*y_2);                                                                                                                                                                          Z(:,:,53)=sqrt(2*(9+1))*( +36.*x_9 +72.*x_7.*y_2 +36.*x_5.*y_4 -56.*x_7 -56.*x_5.*y_2 +21.*x_5 -360.*x_7.*y_2 -720.*x_5.*y_4 -360.*x_3.*y_6 +560.*x_5.*y_2 +560.*x_3.*y_4 -210.*x_3.*y_2 +180.*x_5.*y_4 +360.*x_3.*y_6 +180.*x.*y_8 -280.*x_3.*y_4 -280.*x.*y_6 +105.*x.*y_4);                                                                                                                                                                                                      Z(:,:,54)=sqrt(2*(9+1))*( +9.*x_9 +9.*x_7.*y_2 -8.*x_7 -189.*x_7.*y_2 -189.*x_5.*y_4 +168.*x_5.*y_2 +315.*x_5.*y_4 +315.*x_3.*y_6 -280.*x_3.*y_4 -63.*x_3.*y_6 -63.*x.*y_8 +56.*x.*y_6);                                                                                                                                                                                                                                                                                                      Z(:,:,55)=sqrt(2*(9+1))*( +1.*x_9 -36.*x_7.*y_2 +126.*x_5.*y_4 -84.*x_3.*y_6 +9.*x.*y_8);                                                                                                                                                                                                                                                                                                                                                                                                                 elseif pd=='dx'Z(:,:,1)=zeros(size(x)); Z(:,:,2)=zeros(size(x)); Z(:,:,3)=sqrt(2*(1+1))*( +1);                                                                       Z(:,:,4)=sqrt(2*(2+1))*( +2.*y);                                                                    Z(:,:,5)=sqrt(2+1)*( +4.*x);                                                                        Z(:,:,6)=sqrt(2*(2+1))*( +2.*x);                                                                    Z(:,:,7)=sqrt(2*(3+1))*( +6.*x.*y);                                                                 Z(:,:,8)=sqrt(2*(3+1))*( +6.*x.*y);                                                                 Z(:,:,9)=sqrt(2*(3+1))*( +9.*x_2 +3.*y_2 -2);                                                     Z(:,:,10)=sqrt(2*(3+1))*( +3.*x_2 -3.*y_2);                                                       Z(:,:,11)=sqrt(2*(4+1))*( +12.*x_2.*y -4.*y_3);                                                   Z(:,:,12)=sqrt(2*(4+1))*( +24.*x_2.*y +8.*y_3 -6.*y);                                             Z(:,:,13)=sqrt(4+1)*( +24.*x_3 +24.*x.*y_2 -12.*x);                                               Z(:,:,14)=sqrt(2*(4+1))*( +16.*x_3 +8.*x.*y_2 -6.*x -8.*x.*y_2);                                 Z(:,:,15)=sqrt(2*(4+1))*( +4.*x_3 -12.*x.*y_2);                                                   Z(:,:,16)=sqrt(2*(5+1))*( +20.*x_3.*y -20.*x.*y_3);                                               Z(:,:,17)=sqrt(2*(5+1))*( +60.*x_3.*y +30.*x.*y_3 -24.*x.*y -10.*x.*y_3);                        Z(:,:,18)=sqrt(2*(5+1))*( +40.*x_3.*y +40.*x.*y_3 -24.*x.*y);                                     Z(:,:,19)=sqrt(2*(5+1))*( +50.*x_4 +60.*x_2.*y_2 +10.*y_4 -36.*x_2 -12.*y_2 +3);              Z(:,:,20)=sqrt(2*(5+1))*( +25.*x_4 +15.*x_2.*y_2 -12.*x_2 -45.*x_2.*y_2 -15.*y_4 +12.*y_2); Z(:,:,21)=sqrt(2*(5+1))*( +5.*x_4 -30.*x_2.*y_2 +5.*y_4);                                       Z(:,:,22)=sqrt(2*(6+1))*( +30.*x_4.*y -60.*x_2.*y_3 +6.*y_5);                                                                                                                                                                                                                                                                                                                                                                                              Z(:,:,23)=sqrt(2*(6+1))*( +120.*x_4.*y +72.*x_2.*y_3 -60.*x_2.*y -72.*x_2.*y_3 -24.*y_5 +20.*y_3);                                                                                                                                                                                                                                                                                                                                                     Z(:,:,24)=sqrt(2*(6+1))*( +150.*x_4.*y +180.*x_2.*y_3 +30.*y_5 -120.*x_2.*y -40.*y_3 +12.*y);                                                                                                                                                                                                                                                                                                                                                            Z(:,:,25)=sqrt(6+1)*( +120.*x_5 +240.*x_3.*y_2 +120.*x.*y_4 -120.*x_3 -120.*x.*y_2 +24.*x);                                                                                                                                                                                                                                                                                                                                                              Z(:,:,26)=sqrt(2*(6+1))*( +90.*x_5 +120.*x_3.*y_2 +30.*x.*y_4 -80.*x_3 -40.*x.*y_2 +12.*x -60.*x_3.*y_2 -60.*x.*y_4 +40.*x.*y_2);                                                                                                                                                                                                                                                                                                                    Z(:,:,27)=sqrt(2*(6+1))*( +36.*x_5 +24.*x_3.*y_2 -20.*x_3 -144.*x_3.*y_2 -72.*x.*y_4 +60.*x.*y_2 +12.*x.*y_4);                                                                                                                                                                                                                                                                                                                                        Z(:,:,28)=sqrt(2*(6+1))*( +6.*x_5 -60.*x_3.*y_2 +30.*x.*y_4);                                                                                                                                                                                                                                                                                                                                                                                              Z(:,:,29)=sqrt(2*(7+1))*( +42.*x_5.*y -140.*x_3.*y_3 +42.*x.*y_5);                                                                                                                                                                                                                                                                                                                                                                                         Z(:,:,30)=sqrt(2*(7+1))*( +210.*x_5.*y +140.*x_3.*y_3 -120.*x_3.*y -280.*x_3.*y_3 -140.*x.*y_5 +120.*x.*y_3 +14.*x.*y_5);                                                                                                                                                                                                                                                                                                                             Z(:,:,31)=sqrt(2*(7+1))*( +378.*x_5.*y +504.*x_3.*y_3 +126.*x.*y_5 -360.*x_3.*y -180.*x.*y_3 +60.*x.*y -84.*x_3.*y_3 -84.*x.*y_5 +60.*x.*y_3);                                                                                                                                                                                                                                                                                                       Z(:,:,32)=sqrt(2*(7+1))*( +210.*x_5.*y +420.*x_3.*y_3 +210.*x.*y_5 -240.*x_3.*y -240.*x.*y_3 +60.*x.*y);                                                                                                                                                                                                                                                                                                                                                 Z(:,:,33)=sqrt(2*(7+1))*( +245.*x_6 +525.*x_4.*y_2 +315.*x_2.*y_4 +35.*y_6 -300.*x_4 -360.*x_2.*y_2 -60.*y_4 +90.*x_2 +30.*y_2 -4);                                                                                                                                                                                                                                                                                                                Z(:,:,34)=sqrt(2*(7+1))*( +147.*x_6 +210.*x_4.*y_2 +63.*x_2.*y_4 -150.*x_4 -90.*x_2.*y_2 +30.*x_2 -315.*x_4.*y_2 -378.*x_2.*y_4 -63.*y_6 +270.*x_2.*y_2 +90.*y_4 -30.*y_2);                                                                                                                                                                                                                                                                  Z(:,:,35)=sqrt(2*(7+1))*( +49.*x_6 +35.*x_4.*y_2 -30.*x_4 -350.*x_4.*y_2 -210.*x_2.*y_4 +180.*x_2.*y_2 +105.*x_2.*y_4 +35.*y_6 -30.*y_4);                                                                                                                                                                                                                                                                                                        Z(:,:,36)=sqrt(2*(7+1))*( +7.*x_6 -105.*x_4.*y_2 +105.*x_2.*y_4 -7.*y_6);                                                                                                                                                                                                                                                                                                                                                                                Z(:,:,37)=sqrt(2*(8+1))*( +56.*x_6.*y -280.*x_4.*y_3 +168.*x_2.*y_5 -8.*y_7);                                                                                                                                                                                                                                                                                                                                                                            Z(:,:,38)=sqrt(2*(8+1))*( +336.*x_6.*y +240.*x_4.*y_3 -210.*x_4.*y -800.*x_4.*y_3 -480.*x_2.*y_5 +420.*x_2.*y_3 +144.*x_2.*y_5 +48.*y_7 -42.*y_5);                                                                                                                                                                                                                                                                                               Z(:,:,39)=sqrt(2*(8+1))*( +784.*x_6.*y +1120.*x_4.*y_3 +336.*x_2.*y_5 -840.*x_4.*y -504.*x_2.*y_3 +180.*x_2.*y -560.*x_4.*y_3 -672.*x_2.*y_5 -112.*y_7 +504.*x_2.*y_3 +168.*y_5 -60.*y_3);                                                                                                                                                                                                                                                   Z(:,:,40)=sqrt(2*(8+1))*( +784.*x_6.*y +1680.*x_4.*y_3 +1008.*x_2.*y_5 +112.*y_7 -1050.*x_4.*y -1260.*x_2.*y_3 -210.*y_5 +360.*x_2.*y +120.*y_3 -20.*y);                                                                                                                                                                                                                                                                                           Z(:,:,41)=sqrt(8+1)*( +560.*x_7 +1680.*x_5.*y_2 +1680.*x_3.*y_4 +560.*x.*y_6 -840.*x_5 -1680.*x_3.*y_2 -840.*x.*y_4 +360.*x_3 +360.*x.*y_2 -40.*x);                                                                                                                                                                                                                                                                                                Z(:,:,42)=sqrt(2*(8+1))*( +448.*x_7 +1008.*x_5.*y_2 +672.*x_3.*y_4 +112.*x.*y_6 -630.*x_5 -840.*x_3.*y_2 -210.*x.*y_4 +240.*x_3 +120.*x.*y_2 -20.*x -336.*x_5.*y_2 -672.*x_3.*y_4 -336.*x.*y_6 +420.*x_3.*y_2 +420.*x.*y_4 -120.*x.*y_2);                                                                                                                                                                                                 Z(:,:,43)=sqrt(2*(8+1))*( +224.*x_7 +336.*x_5.*y_2 +112.*x_3.*y_4 -252.*x_5 -168.*x_3.*y_2 +60.*x_3 -1008.*x_5.*y_2 -1344.*x_3.*y_4 -336.*x.*y_6 +1008.*x_3.*y_2 +504.*x.*y_4 -180.*x.*y_2 +112.*x_3.*y_4 +112.*x.*y_6 -84.*x.*y_4);                                                                                                                                                                                                     Z(:,:,44)=sqrt(2*(8+1))*( +64.*x_7 +48.*x_5.*y_2 -42.*x_5 -720.*x_5.*y_2 -480.*x_3.*y_4 +420.*x_3.*y_2 +480.*x_3.*y_4 +240.*x.*y_6 -210.*x.*y_4 -16.*x.*y_6);                                                                                                                                                                                                                                                                                   Z(:,:,45)=sqrt(2*(8+1))*( +8.*x_7 -168.*x_5.*y_2 +280.*x_3.*y_4 -56.*x.*y_6);                                                                                                                                                                                                                                                                                                                                                                            Z(:,:,46)=sqrt(2*(9+1))*( +72.*x_7.*y -504.*x_5.*y_3 +504.*x_3.*y_5 -72.*x.*y_7);                                                                                                                                                                                                                                                                                                                                                                        Z(:,:,47)=sqrt(2*(9+1))*( +504.*x_7.*y +378.*x_5.*y_3 -336.*x_5.*y -1890.*x_5.*y_3 -1260.*x_3.*y_5 +1120.*x_3.*y_3 +756.*x_3.*y_5 +378.*x.*y_7 -336.*x.*y_5 -18.*x.*y_7);                                                                                                                                                                                                                                                                       Z(:,:,48)=sqrt(2*(9+1))*( +1440.*x_7.*y +2160.*x_5.*y_3 +720.*x_3.*y_5 -1680.*x_5.*y -1120.*x_3.*y_3 +420.*x_3.*y -2160.*x_5.*y_3 -2880.*x_3.*y_5 -720.*x.*y_7 +2240.*x_3.*y_3 +1120.*x.*y_5 -420.*x.*y_3 +144.*x_3.*y_5 +144.*x.*y_7 -112.*x.*y_5);                                                                                                                                                                                     Z(:,:,49)=sqrt(2*(9+1))*( +2016.*x_7.*y +4536.*x_5.*y_3 +3024.*x_3.*y_5 +504.*x.*y_7 -3024.*x_5.*y -4032.*x_3.*y_3 -1008.*x.*y_5 +1260.*x_3.*y +630.*x.*y_3 -120.*x.*y -504.*x_5.*y_3 -1008.*x_3.*y_5 -504.*x.*y_7 +672.*x_3.*y_3 +672.*x.*y_5 -210.*x.*y_3);                                                                                                                                                                             Z(:,:,50)=sqrt(2*(9+1))*( +1008.*x_7.*y +3024.*x_5.*y_3 +3024.*x_3.*y_5 +1008.*x.*y_7 -1680.*x_5.*y -3360.*x_3.*y_3 -1680.*x.*y_5 +840.*x_3.*y +840.*x.*y_3 -120.*x.*y);                                                                                                                                                                                                                                                                           Z(:,:,51)=sqrt(2*(9+1))*( +1134.*x_8 +3528.*x_6.*y_2 +3780.*x_4.*y_4 +1512.*x_2.*y_6 +126.*y_8 -1960.*x_6 -4200.*x_4.*y_2 -2520.*x_2.*y_4 -280.*y_6 +1050.*x_4 +1260.*x_2.*y_2 +210.*y_4 -180.*x_2 -60.*y_2 +5);                                                                                                                                                                                                                           Z(:,:,52)=sqrt(2*(9+1))*( +756.*x_8 +1764.*x_6.*y_2 +1260.*x_4.*y_4 +252.*x_2.*y_6 -1176.*x_6 -1680.*x_4.*y_2 -504.*x_2.*y_4 +525.*x_4 +315.*x_2.*y_2 -60.*x_2 -1764.*x_6.*y_2 -3780.*x_4.*y_4 -2268.*x_2.*y_6 -252.*y_8 +2520.*x_4.*y_2 +3024.*x_2.*y_4 +504.*y_6 -945.*x_2.*y_2 -315.*y_4 +60.*y_2);                                                                                                                         Z(:,:,53)=sqrt(2*(9+1))*( +324.*x_8 +504.*x_6.*y_2 +180.*x_4.*y_4 -392.*x_6 -280.*x_4.*y_2 +105.*x_4 -2520.*x_6.*y_2 -3600.*x_4.*y_4 -1080.*x_2.*y_6 +2800.*x_4.*y_2 +1680.*x_2.*y_4 -630.*x_2.*y_2 +900.*x_4.*y_4 +1080.*x_2.*y_6 +180.*y_8 -840.*x_2.*y_4 -280.*y_6 +105.*y_4);                                                                                                                                                Z(:,:,54)=sqrt(2*(9+1))*( +81.*x_8 +63.*x_6.*y_2 -56.*x_6 -1323.*x_6.*y_2 -945.*x_4.*y_4 +840.*x_4.*y_2 +1575.*x_4.*y_4 +945.*x_2.*y_6 -840.*x_2.*y_4 -189.*x_2.*y_6 -63.*y_8 +56.*y_6);                                                                                                                                                                                                                                                   Z(:,:,55)=sqrt(2*(9+1))*( +9.*x_8 -252.*x_6.*y_2 +630.*x_4.*y_4 -252.*x_2.*y_6 +9.*y_8);                                                                                                                                                                                                                                                                                                                                                               elseif pd=='dy'Z(:,:,1)=zeros(size(x)); Z(:,:,2)=sqrt(2*(1+1))*ones(size(x));                                                                       Z(:,:,3)=zeros(size(x));                                                                          Z(:,:,4)=sqrt(2*(2+1))*( +2.*x);                                                                    Z(:,:,5)=sqrt(2+1)*( +4.*y);                                                                        Z(:,:,6)=sqrt(2*(2+1))*( -2.*y);                                                                    Z(:,:,7)=sqrt(2*(3+1))*( +3.*x_2 -3.*y_2);                                                        Z(:,:,8)=sqrt(2*(3+1))*( +3.*x_2 +9.*y_2 -2);                                                     Z(:,:,9)=sqrt(2*(3+1))*( +6.*x.*y);                                                                 Z(:,:,10)=sqrt(2*(3+1))*( -6.*x.*y);                                                                Z(:,:,11)=sqrt(2*(4+1))*( +4.*x_3 -12.*x.*y_2);                                                   Z(:,:,12)=sqrt(2*(4+1))*( +8.*x_3 +24.*x.*y_2 -6.*x);                                             Z(:,:,13)=sqrt(4+1)*( +24.*x_2.*y +24.*y_3 -12.*y);                                               Z(:,:,14)=sqrt(2*(4+1))*( +8.*x_2.*y -8.*x_2.*y -16.*y_3 +6.*y);                                 Z(:,:,15)=sqrt(2*(4+1))*( -12.*x_2.*y +4.*y_3);                                                   Z(:,:,16)=sqrt(2*(5+1))*( +5.*x_4 -30.*x_2.*y_2 +5.*y_4);                                       Z(:,:,17)=sqrt(2*(5+1))*( +15.*x_4 +45.*x_2.*y_2 -12.*x_2 -15.*x_2.*y_2 -25.*y_4 +12.*y_2); Z(:,:,18)=sqrt(2*(5+1))*( +10.*x_4 +60.*x_2.*y_2 +50.*y_4 -12.*x_2 -36.*y_2 +3);              Z(:,:,19)=sqrt(2*(5+1))*( +40.*x_3.*y +40.*x.*y_3 -24.*x.*y);                                     Z(:,:,20)=sqrt(2*(5+1))*( +10.*x_3.*y -30.*x_3.*y -60.*x.*y_3 +24.*x.*y);                        Z(:,:,21)=sqrt(2*(5+1))*( -20.*x_3.*y +20.*x.*y_3);                                               Z(:,:,22)=sqrt(2*(6+1))*( +6.*x_5 -60.*x_3.*y_2 +30.*x.*y_4);                                                                                                                                                                                                                                                                                                                                                                                              Z(:,:,23)=sqrt(2*(6+1))*( +24.*x_5 +72.*x_3.*y_2 -20.*x_3 -72.*x_3.*y_2 -120.*x.*y_4 +60.*x.*y_2);                                                                                                                                                                                                                                                                                                                                                     Z(:,:,24)=sqrt(2*(6+1))*( +30.*x_5 +180.*x_3.*y_2 +150.*x.*y_4 -40.*x_3 -120.*x.*y_2 +12.*x);                                                                                                                                                                                                                                                                                                                                                            Z(:,:,25)=sqrt(6+1)*( +120.*x_4.*y +240.*x_2.*y_3 +120.*y_5 -120.*x_2.*y -120.*y_3 +24.*y);                                                                                                                                                                                                                                                                                                                                                              Z(:,:,26)=sqrt(2*(6+1))*( +60.*x_4.*y +60.*x_2.*y_3 -40.*x_2.*y -30.*x_4.*y -120.*x_2.*y_3 -90.*y_5 +40.*x_2.*y +80.*y_3 -12.*y);                                                                                                                                                                                                                                                                                                                    Z(:,:,27)=sqrt(2*(6+1))*( +12.*x_4.*y -72.*x_4.*y -144.*x_2.*y_3 +60.*x_2.*y +24.*x_2.*y_3 +36.*y_5 -20.*y_3);                                                                                                                                                                                                                                                                                                                                        Z(:,:,28)=sqrt(2*(6+1))*( -30.*x_4.*y +60.*x_2.*y_3 -6.*y_5);                                                                                                                                                                                                                                                                                                                                                                                              Z(:,:,29)=sqrt(2*(7+1))*( +7.*x_6 -105.*x_4.*y_2 +105.*x_2.*y_4 -7.*y_6);                                                                                                                                                                                                                                                                                                                                                                                Z(:,:,30)=sqrt(2*(7+1))*( +35.*x_6 +105.*x_4.*y_2 -30.*x_4 -210.*x_4.*y_2 -350.*x_2.*y_4 +180.*x_2.*y_2 +35.*x_2.*y_4 +49.*y_6 -30.*y_4);                                                                                                                                                                                                                                                                                                        Z(:,:,31)=sqrt(2*(7+1))*( +63.*x_6 +378.*x_4.*y_2 +315.*x_2.*y_4 -90.*x_4 -270.*x_2.*y_2 +30.*x_2 -63.*x_4.*y_2 -210.*x_2.*y_4 -147.*y_6 +90.*x_2.*y_2 +150.*y_4 -30.*y_2);                                                                                                                                                                                                                                                                  Z(:,:,32)=sqrt(2*(7+1))*( +35.*x_6 +315.*x_4.*y_2 +525.*x_2.*y_4 +245.*y_6 -60.*x_4 -360.*x_2.*y_2 -300.*y_4 +30.*x_2 +90.*y_2 -4);                                                                                                                                                                                                                                                                                                                Z(:,:,33)=sqrt(2*(7+1))*( +210.*x_5.*y +420.*x_3.*y_3 +210.*x.*y_5 -240.*x_3.*y -240.*x.*y_3 +60.*x.*y);                                                                                                                                                                                                                                                                                                                                                 Z(:,:,34)=sqrt(2*(7+1))*( +84.*x_5.*y +84.*x_3.*y_3 -60.*x_3.*y -126.*x_5.*y -504.*x_3.*y_3 -378.*x.*y_5 +180.*x_3.*y +360.*x.*y_3 -60.*x.*y);                                                                                                                                                                                                                                                                                                       Z(:,:,35)=sqrt(2*(7+1))*( +14.*x_5.*y -140.*x_5.*y -280.*x_3.*y_3 +120.*x_3.*y +140.*x_3.*y_3 +210.*x.*y_5 -120.*x.*y_3);                                                                                                                                                                                                                                                                                                                             Z(:,:,36)=sqrt(2*(7+1))*( -42.*x_5.*y +140.*x_3.*y_3 -42.*x.*y_5);                                                                                                                                                                                                                                                                                                                                                                                         Z(:,:,37)=sqrt(2*(8+1))*( +8.*x_7 -168.*x_5.*y_2 +280.*x_3.*y_4 -56.*x.*y_6);                                                                                                                                                                                                                                                                                                                                                                            Z(:,:,38)=sqrt(2*(8+1))*( +48.*x_7 +144.*x_5.*y_2 -42.*x_5 -480.*x_5.*y_2 -800.*x_3.*y_4 +420.*x_3.*y_2 +240.*x_3.*y_4 +336.*x.*y_6 -210.*x.*y_4);                                                                                                                                                                                                                                                                                               Z(:,:,39)=sqrt(2*(8+1))*( +112.*x_7 +672.*x_5.*y_2 +560.*x_3.*y_4 -168.*x_5 -504.*x_3.*y_2 +60.*x_3 -336.*x_5.*y_2 -1120.*x_3.*y_4 -784.*x.*y_6 +504.*x_3.*y_2 +840.*x.*y_4 -180.*x.*y_2);                                                                                                                                                                                                                                                   Z(:,:,40)=sqrt(2*(8+1))*( +112.*x_7 +1008.*x_5.*y_2 +1680.*x_3.*y_4 +784.*x.*y_6 -210.*x_5 -1260.*x_3.*y_2 -1050.*x.*y_4 +120.*x_3 +360.*x.*y_2 -20.*x);                                                                                                                                                                                                                                                                                           Z(:,:,41)=sqrt(8+1)*( +560.*x_6.*y +1680.*x_4.*y_3 +1680.*x_2.*y_5 +560.*y_7 -840.*x_4.*y -1680.*x_2.*y_3 -840.*y_5 +360.*x_2.*y +360.*y_3 -40.*y);                                                                                                                                                                                                                                                                                                Z(:,:,42)=sqrt(2*(8+1))*( +336.*x_6.*y +672.*x_4.*y_3 +336.*x_2.*y_5 -420.*x_4.*y -420.*x_2.*y_3 +120.*x_2.*y -112.*x_6.*y -672.*x_4.*y_3 -1008.*x_2.*y_5 -448.*y_7 +210.*x_4.*y +840.*x_2.*y_3 +630.*y_5 -120.*x_2.*y -240.*y_3 +20.*y);                                                                                                                                                                                                 Z(:,:,43)=sqrt(2*(8+1))*( +112.*x_6.*y +112.*x_4.*y_3 -84.*x_4.*y -336.*x_6.*y -1344.*x_4.*y_3 -1008.*x_2.*y_5 +504.*x_4.*y +1008.*x_2.*y_3 -180.*x_2.*y +112.*x_4.*y_3 +336.*x_2.*y_5 +224.*y_7 -168.*x_2.*y_3 -252.*y_5 +60.*y_3);                                                                                                                                                                                                     Z(:,:,44)=sqrt(2*(8+1))*( +16.*x_6.*y -240.*x_6.*y -480.*x_4.*y_3 +210.*x_4.*y +480.*x_4.*y_3 +720.*x_2.*y_5 -420.*x_2.*y_3 -48.*x_2.*y_5 -64.*y_7 +42.*y_5);                                                                                                                                                                                                                                                                                   Z(:,:,45)=sqrt(2*(8+1))*( -56.*x_6.*y +280.*x_4.*y_3 -168.*x_2.*y_5 +8.*y_7);                                                                                                                                                                                                                                                                                                                                                                            Z(:,:,46)=sqrt(2*(9+1))*( +9.*x_8 -252.*x_6.*y_2 +630.*x_4.*y_4 -252.*x_2.*y_6 +9.*y_8);                                                                                                                                                                                                                                                                                                                                                               Z(:,:,47)=sqrt(2*(9+1))*( +63.*x_8 +189.*x_6.*y_2 -56.*x_6 -945.*x_6.*y_2 -1575.*x_4.*y_4 +840.*x_4.*y_2 +945.*x_4.*y_4 +1323.*x_2.*y_6 -840.*x_2.*y_4 -63.*x_2.*y_6 -81.*y_8 +56.*y_6);                                                                                                                                                                                                                                                   Z(:,:,48)=sqrt(2*(9+1))*( +180.*x_8 +1080.*x_6.*y_2 +900.*x_4.*y_4 -280.*x_6 -840.*x_4.*y_2 +105.*x_4 -1080.*x_6.*y_2 -3600.*x_4.*y_4 -2520.*x_2.*y_6 +1680.*x_4.*y_2 +2800.*x_2.*y_4 -630.*x_2.*y_2 +180.*x_4.*y_4 +504.*x_2.*y_6 +324.*y_8 -280.*x_2.*y_4 -392.*y_6 +105.*y_4);                                                                                                                                                Z(:,:,49)=sqrt(2*(9+1))*( +252.*x_8 +2268.*x_6.*y_2 +3780.*x_4.*y_4 +1764.*x_2.*y_6 -504.*x_6 -3024.*x_4.*y_2 -2520.*x_2.*y_4 +315.*x_4 +945.*x_2.*y_2 -60.*x_2 -252.*x_6.*y_2 -1260.*x_4.*y_4 -1764.*x_2.*y_6 -756.*y_8 +504.*x_4.*y_2 +1680.*x_2.*y_4 +1176.*y_6 -315.*x_2.*y_2 -525.*y_4 +60.*y_2);                                                                                                                         Z(:,:,50)=sqrt(2*(9+1))*( +126.*x_8 +1512.*x_6.*y_2 +3780.*x_4.*y_4 +3528.*x_2.*y_6 +1134.*y_8 -280.*x_6 -2520.*x_4.*y_2 -4200.*x_2.*y_4 -1960.*y_6 +210.*x_4 +1260.*x_2.*y_2 +1050.*y_4 -60.*x_2 -180.*y_2 +5);                                                                                                                                                                                                                           Z(:,:,51)=sqrt(2*(9+1))*( +1008.*x_7.*y +3024.*x_5.*y_3 +3024.*x_3.*y_5 +1008.*x.*y_7 -1680.*x_5.*y -3360.*x_3.*y_3 -1680.*x.*y_5 +840.*x_3.*y +840.*x.*y_3 -120.*x.*y);                                                                                                                                                                                                                                                                           Z(:,:,52)=sqrt(2*(9+1))*( +504.*x_7.*y +1008.*x_5.*y_3 +504.*x_3.*y_5 -672.*x_5.*y -672.*x_3.*y_3 +210.*x_3.*y -504.*x_7.*y -3024.*x_5.*y_3 -4536.*x_3.*y_5 -2016.*x.*y_7 +1008.*x_5.*y +4032.*x_3.*y_3 +3024.*x.*y_5 -630.*x_3.*y -1260.*x.*y_3 +120.*x.*y);                                                                                                                                                                             Z(:,:,53)=sqrt(2*(9+1))*( +144.*x_7.*y +144.*x_5.*y_3 -112.*x_5.*y -720.*x_7.*y -2880.*x_5.*y_3 -2160.*x_3.*y_5 +1120.*x_5.*y +2240.*x_3.*y_3 -420.*x_3.*y +720.*x_5.*y_3 +2160.*x_3.*y_5 +1440.*x.*y_7 -1120.*x_3.*y_3 -1680.*x.*y_5 +420.*x.*y_3);                                                                                                                                                                                     Z(:,:,54)=sqrt(2*(9+1))*( +18.*x_7.*y -378.*x_7.*y -756.*x_5.*y_3 +336.*x_5.*y +1260.*x_5.*y_3 +1890.*x_3.*y_5 -1120.*x_3.*y_3 -378.*x_3.*y_5 -504.*x.*y_7 +336.*x.*y_5);                                                                                                                                                                                                                                                                       Z(:,:,55)=sqrt(2*(9+1))*( -72.*x_7.*y +504.*x_5.*y_3 -504.*x_3.*y_5 +72.*x.*y_7);                                                                                                                                                                                                                                                                                                                                                                        end